{"version":3,"sources":["fair-launch.ts","candy-machine.ts","utils.ts","connection.tsx","Home.tsx","countdown.tsx","confetti.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["LotteryState","FAIR_LAUNCH_PROGRAM","anchor","PublicKey","getFairLaunchState","anchorWallet","fairLaunchId","connection","a","provider","preflightCommitment","fetchIdl","idl","program","account","fairLaunch","fetch","state","getFairLaunchTicket","tokenMint","publicKey","fairLaunchTicket","bump","fairLaunchData","console","log","getBalance","treasury","lotteryData","Uint8Array","getFairLaunchLotteryBitmap","fairLaunchLotteryBitmap","getAccountInfo","fairLaunchLotteryBitmapObj","data","id","ticket","pubkey","lottery","punchTicket","getAtaForMint","buyerTokenAccount","amount","gt","currentMedian","toNumber","getSetupForTicketing","remainingAccounts","instructions","signers","rpc","adjustTicket","accounts","systemProgram","SystemProgram","programId","clock","SYSVAR_CLOCK_PUBKEY","currentWinner","__private","logAccounts","length","undefined","isSigner","isWritable","accountExists","createAssociatedTokenAccountInstruction","payer","tokenProgram","TOKEN_PROGRAM_ID","buyer","findProgramAddress","Buffer","from","toBuffer","anchorProgram","ticketKey","amountLamports","treasuryMint","Math","ceil","LAMPORTS_PER_SOL","priceRangeStart","transferAuthority","Keypair","generate","push","Token","createApproveInstruction","amountNumber","fees","getFairLaunchTicketSeqLookup","seq","fairLaunchTicketSeqLookup","seqBump","instruction","createTicketSeq","rent","SYSVAR_RENT_PUBKEY","receiveRefund","toBase58","purchaseTicket","CANDY_MACHINE_PROGRAM","TOKEN_METADATA_PROGRAM_ID","awaitTransactionSignatureConfirmation","txid","timeout","queryStatus","done","status","slot","confirmations","err","subId","Promise","resolve","reject","setTimeout","getSignatureStatuses","signatureStatuses","value","sleep","_signatureSubscriptions","removeSignatureListener","associatedTokenAddress","walletAddress","splTokenMintAddress","keys","TransactionInstruction","SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID","getCandyMachineState","candyMachineId","candyMachine","itemsAvailable","itemsRedeemed","itemsRemaining","isSoldOut","isActive","goLiveDate","Date","getTime","wallet","config","price","getMasterEdition","mint","getMetadata","mintOneToken","userTokenAccountAddress","userPayingAccountAddress","candyMachineAddress","MintLayout","span","getMinimumBalanceForRentExemption","fromPubkey","newAccountPubkey","space","lamports","createAccount","createInitMintInstruction","createMintToInstruction","metadataAddress","masterEdition","mintNft","metadata","mintAuthority","updateAuthority","tokenMetadataProgram","sendTransactionWithRetry","ms","FAIR_LAUNCH_PROGRAM_ID","toDate","numberFormater","Intl","NumberFormat","style","minimumFractionDigits","maximumFractionDigits","formatNumber","format","val","asNumber","toArrayLike","SequenceType","commitment","includesFeePayer","block","beforeSend","WalletNotConnectedError","transaction","Transaction","forEach","add","getRecentBlockhash","recentBlockhash","blockhash","setSigners","map","s","partialSign","signTransaction","sendSignedTransaction","signedTransaction","getUnixTs","DEFAULT_TIMEOUT","rawTransaction","serialize","startTime","sendRawTransaction","skipPreflight","confirmation","Error","error","simulateResult","simulateTransaction","logs","i","line","startsWith","slice","JSON","stringify","_recentBlockhash","_disableBlockhashCaching","signData","serializeMessage","wireTransaction","_serialize","encodedTransaction","toString","args","encoding","_rpcRequest","res","message","result","onSignature","context","e","Phase","useStyles","makeStyles","theme","createStyles","root","display","padding","spacing","margin","marginRight","width","height","flexDirection","alignContent","alignItems","justifyContent","background","color","borderRadius","fontSize","fontWeight","item","PhaseCountdown","date","start","end","onComplete","classes","useState","now","isFixed","renderCountdown","days","hours","minutes","seconds","completed","className","Paper","elevation","renderer","ConnectButton","styled","WalletDialogButton","MintContainer","div","MintButton","Button","dialogStyles","closeButton","position","right","top","palette","grey","ValueSlider","Slider","border","marginTop","boxShadow","lineHeight","marginLeft","Header","props","phaseName","desc","Grid","container","xs","direction","Typography","variant","getPhase","curr","phaseOne","phaseOneStart","phaseOneEnd","phaseTwoEnd","candyMachineGoLive","Phase0","Phase1","Phase2","phaseThreeStarted","Lottery","Phase4","Phase3","Unknown","isWinner","myByte","floor","positionFromRight","pow","Home","fairLaunchBalance","setFairLaunchBalance","yourSOLBalance","setYourSOLBalance","isMinting","setIsMinting","contributed","setContributed","useWallet","useMemo","signAllTransactions","open","severity","alertState","setAlertState","setFairLaunch","setCandyMachine","howToOpen","setHowToOpen","refundExplainerOpen","setRefundExplainerOpen","antiRugPolicyOpen","setAnitRugPolicyOpen","onMint","connected","unpunched","onPunchTicket","mintTxId","txTimeout","msg","code","window","location","reload","indexOf","useEffect","balance","getTokenAccountBalance","uiAmount","ticks","priceRangeEnd","tickSize","randomTick","round","random","cndy","min","max","step","median","phase","marks","label","filter","_","onDeposit","onRugRefund","onRefundTicket","candyMachinePredatesFairLaunch","lt","notEnoughSOL","fee","Container","maxWidth","backgroundColor","lotteryDuration","marginBottom","includes","withdrawn","paddingTop","Alert","onChange","ev","valueLabelDisplay","CircularProgress","onClick","disabled","punched","Link","component","align","Dialog","onClose","PaperProps","antiRugSetting","selfDestructDate","reserveBp","tokenRequirement","numberOfTokens","toLocaleDateString","toLocaleTimeString","textAlign","disableTypography","IconButton","gutterBottom","toLocaleString","wrap","md","numberTicketsSold","Snackbar","autoHideDuration","ConfettiContext","React","createContext","ConfettiProvider","children","canvasRef","useRef","confettiRef","dropConfetti","current","visibility","particleCount","spread","origin","y","finally","confetti","create","resize","useWorker","Provider","ref","zIndex","left","createTheme","type","process","Connection","startDateSeed","parseInt","REACT_APP_CANDY_START_DATE","App","endpoint","clusterApiUrl","wallets","getPhantomWallet","getSolflareWallet","getSolletWallet","ThemeProvider","autoConnect","startDate","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"yRAoFYA,E,uEA1ECC,EAAsB,IAAIC,IAAYC,UACjD,gD,SAyEUH,K,kBAAAA,E,oBAAAA,E,oBAAAA,M,KAML,IAmBMI,EAAkB,uCAAG,WAChCC,EACAC,EACAC,GAHgC,uCAAAC,EAAA,6DAK1BC,EAAW,IAAIP,IAAgBK,EAAYF,EAAc,CAC7DK,oBAAqB,WANS,SASdR,IAAeS,SAASV,EAAqBQ,GAT/B,cAS1BG,EAT0B,OAW1BC,EAAU,IAAIX,IAAeU,EAAKX,EAAqBQ,GAX7B,SAYPI,EAAQC,QAAQC,WAAWC,MAAMV,GAZ1B,cAY1BW,EAZ0B,iBAcOC,EAErCD,EAAME,UACNd,EAAae,WAjBiB,2CAczBC,EAdyB,KAcPC,EAdO,yBAuBPT,EAAQC,QAAQO,iBAAiBL,MACtDK,GAxB4B,QAuB9BE,EAvB8B,0DA2B9BC,QAAQC,IAAI,aA3BkB,yBA8BTZ,EAAQJ,SAASF,WAAWmB,WAAWT,EAAMU,UA9BpC,eA8B1BA,EA9B0B,OAgC5BC,EAA0B,IAAIC,WAAW,IAhCb,UAkCxBC,EAEJb,EAAME,WApCsB,eAiC5BY,EAjC4B,OAsC9B,GAtC8B,oBA0CtBlB,EAAQJ,SAASF,WAAWyB,eAAeD,GA1CrB,QAyCxBE,EAzCwB,OA4C9BL,EAAc,IAAIC,YAAqC,OAA1BI,QAA0B,IAA1BA,OAAA,EAAAA,EAA4BC,OAAQ,IA5CnC,mDA8C9BV,QAAQC,IAAI,uCACZD,QAAQC,IAAR,MA/C8B,iCAkDzB,CACLU,GAAI7B,EACJW,QACAJ,UACAuB,OAAQ,CACNC,OAAQhB,EACRC,OACAY,KAAMX,GAERe,QAAS,CACPD,OAAQN,EACRG,KAAMN,GAERD,aA/D8B,mEAAH,0DAmElBY,EAAW,uCAAG,WACzBlC,EACAU,GAFyB,iCAAAP,EAAA,sEAKjBU,EAEJH,EAAWE,MAAME,UACjBd,EAAae,WARQ,cAInBC,EAJmB,OAUvB,GAEIe,EAASrB,EAAWqB,OAAOF,KAZR,SAejBJ,EAA2Bf,EAAWE,MAAME,WAf3B,cAcnBY,EAdmB,OAgBvB,GAhBuB,SAmBjBS,YAEJzB,EAAWE,MAAME,UACjBd,EAAae,WAtBQ,UAkBnBqB,EAlBmB,OAwBvB,KAxBuB,OA0BrBL,QA1BqB,IA0BrBA,OA1BqB,EA0BrBA,EAAQM,OAAOC,GAAG5B,EAAWE,MAAM2B,gBA1Bd,wBA2BvBpB,QAAQC,IACN,oBADF,OAEEW,QAFF,IAEEA,OAFF,EAEEA,EAAQM,OAAOG,WACf9B,EAAWE,MAAM2B,cAAcC,YA9BV,UAiCfC,EACJ/B,EAAWF,QACXE,EAAWE,MAAM2B,cAAcC,WAC/BxC,EACAU,EACAM,GAtCmB,wBAgCf0B,EAhCe,EAgCfA,kBAAmBC,EAhCJ,EAgCIA,aAAcC,EAhClB,EAgCkBA,QAhClB,UAwCjBlC,EAAWF,QAAQqC,IAAIC,aAAapC,EAAWE,MAAM2B,cAAe,CACxEQ,SAAU,CACR/B,mBACAN,WAAYA,EAAWoB,GACvBJ,0BAEAJ,SAAUZ,EAAWE,MAAMU,SAC3B0B,cAAenD,IAAYoD,cAAcC,UACzCC,MAAOtD,IAAYuD,oBACnBC,cAAe3C,EAAWE,MAAMiB,KAAKwB,eAEvCC,UAAW,CAAEC,aAAa,GAC1BZ,aAAcA,EAAaa,OAAS,EAAIb,OAAec,EACvDf,kBAAkB,CAChB,CACEV,OAAQhC,EAAae,UACrB2C,UAAU,EACVC,YAAY,IAJC,mBAMZjB,IAELE,YA7DqB,yBAkEjBlC,EAAWF,QAAQJ,SAASF,WAAWyB,eAC3CS,GAnEqB,eAiEnBwB,EAjEmB,OAsEnBjB,EAAgBiB,EAUlB,GATA,CACEC,YACEzB,EACApC,EAAae,UACbf,EAAae,UAEbL,EAAWE,MAAME,YA7EA,UAkFnBJ,EAAWF,QAAQqC,IAAIX,YAAY,CACvCa,SAAU,CACR/B,mBACAN,WAAYA,EAAWoB,GACvBJ,0BACAoC,MAAO9D,EAAae,UACpBqB,oBAEAtB,UAAWJ,EAAWE,MAAME,UAC5BiD,aAAcC,KAEhBrB,aAAcA,EAAaa,OAAS,EAAIb,OAAec,IA7FhC,4CAAH,wDAiGX5C,EAAmB,uCAAG,WACjCC,EACAmD,GAFiC,SAAA9D,EAAA,sEAIpBN,IAAYC,UAAUoE,mBACjC,CAACC,EAAOC,KAAK,eAAgBtD,EAAUuD,WAAYJ,EAAMI,YACzDzE,GAN+B,mFAAH,wDAUnB6B,EAA0B,uCAAG,WACxCX,GADwC,SAAAX,EAAA,sEAG3BN,IAAYC,UAAUoE,mBACjC,CAACC,EAAOC,KAAK,eAAgBtD,EAAUuD,WAAYF,EAAOC,KAAK,YAC/DxE,GALsC,mFAAH,sDASjC6C,EAAoB,uCAAG,WAC3B6B,EACAjC,EACArC,EACAU,EACA6D,GAL2B,mCAAApE,EAAA,yDAgBtBO,EAhBsB,yCAiBlB,CACLgC,kBAAmB,GACnBC,aAAc,GACdC,QAAS,GACT4B,eAAgB,IArBO,UAwBrBzC,EAASrB,EAAWqB,OAEpBW,EAAoB,GACpBC,EAAe,GACfC,EAAU,GAEZ4B,EAAiB,EAEhB9D,EAAWE,MAAM6D,aAhCK,iBAoCvBD,EAHGzC,GAAqB,IAAXM,EAGIqC,KAAKC,KAAKtC,EAASuC,oBAFnBlE,EAAWE,MAAMiB,KAAKgD,gBAAgBrC,WAlChC,+BAuCnBsC,EAAoBjF,IAAYkF,QAAQC,WAC9CpC,EAAQqC,KAAKH,GAcbnC,EAAasC,KACXC,IAAMC,yBACJnB,IAEAtD,EAAWE,MAAM6D,aACjBK,EAAkB/D,UAClBf,EAAae,UACb,GAIAqE,aAAe1E,EAAWE,MAAMiB,KAAKwD,KAAK7C,aAI9CE,EAAkBuC,KAAK,CAErBjD,OAAQtB,EAAWE,MAAM6D,aACzBd,YAAY,EACZD,UAAU,IAzEa,KA2EzBhB,EA3EyB,UA6EfP,YAEJzB,EAAWE,MAAM6D,aACjBzE,EAAae,WAhFM,oBAkFrB,GAlFqB,MA4EvBiB,OA5EuB,KAmFvB2B,YAAY,EACZD,UAAU,GApFa,KA2EPuB,KA3EO,gBAsFzBvC,EAAkBuC,KAAK,CACrBjD,OAAQ8C,EAAkB/D,UAC1B4C,YAAY,EACZD,UAAU,IAEZhB,EAAkBuC,KAAK,CACrBjD,OAAQgC,IACRL,YAAY,EACZD,UAAU,IA9Fa,YAkGvB3B,EAAOF,KAlGgB,kCAoGjByD,YACJ5E,EAAWE,MAAME,UADe,UAEhCiB,EAAOF,YAFyB,aAEhC,EAAa0D,KAtGQ,2CAmGlBC,EAnGkB,KAmGSC,EAnGT,eAyGPnB,EAAclE,SAASF,WAAWyB,eAClD6D,GA1GuB,+CA6GvB7C,EA7GuB,UA8Gf2B,EAAcoB,YAAYC,gBAAgBF,EAAS,CACvD1C,SAAU,CACRyC,4BACA9E,WAAYA,EAAWoB,GACvBd,iBAAkBuD,EAClBT,MAAO9D,EAAae,UACpBiC,cAAenD,IAAYoD,cAAcC,UACzC0C,KAAM/F,IAAYgG,oBAEpBjD,QAAS,KAvHU,yBA6GVqC,KA7GU,iDA6HpB,CACLvC,oBACAC,eACAC,UACA4B,mBAjIyB,4CAAH,8DAqIbsB,EAAa,uCAAG,WAC3B9F,EACAU,GAF2B,uBAAAP,EAAA,yDAItBO,EAJsB,iEASnByB,YAAczB,EAAWE,MAAME,UAAWd,EAAae,WATpC,UAQrBqB,EARqB,OAUzB,GAEI0C,EAAoBjF,IAAYkF,QAAQC,WAExCpC,EAAU,CAACkC,GACXnC,EAAe,CACnBuC,IAAMC,yBACJnB,IACA5B,EACA0C,EAAkB/D,UAClBf,EAAae,UACb,GACA,IAIE2B,EAAoB,IAEtBhC,EAAWE,MAAM6D,aA5BM,wBA6BzB/B,EAAkBuC,KAAK,CACrBjD,OAAQtB,EAAWE,MAAM6D,aACzBd,YAAY,EACZD,UAAU,IAhCa,KAkCzBhB,EAlCyB,UAoCfP,YACJzB,EAAWE,MAAM6D,aACjBzE,EAAae,WAtCM,oBAwCrB,GAxCqB,MAmCvBiB,OAnCuB,KAyCvB2B,YAAY,EACZD,UAAU,GA1Ca,KAkCPuB,KAlCO,+BA8C3B9D,QAAQC,IACN,MACAV,EAAWE,MAAMU,SAASyE,WAC1B/F,EAAae,UAAUgF,WACvB3D,EAAkB2D,YAlDO,UAoDrBrF,EAAWF,QAAQqC,IAAIiD,cAAc,CACzC/C,SAAU,CACRrC,WAAYA,EAAWoB,GACvBR,SAAUZ,EAAWE,MAAMU,SAC3B2C,MAAOjE,EAAae,UACpBqB,oBACA0C,kBAAmBA,EAAkB/D,UACrCD,UAAWJ,EAAWE,MAAME,UAC5BiD,aAAcC,IACdhB,cAAenD,IAAYoD,cAAcC,UACzCC,MAAOtD,IAAYuD,qBAGrBE,UAAW,CAAEC,aAAa,GAC1Bb,oBACAC,eACAC,YApEyB,4CAAH,wDAuEboD,EAAc,uCAAG,WAC5B3D,EACArC,EACAU,GAH4B,mCAAAP,EAAA,yDAKvBO,EALuB,wDAStBqB,EAASrB,EAAWqB,OAAOF,KATL,SAWWhB,EAErCH,EAAWE,MAAME,UACjBd,EAAae,WAda,0CAWrBC,EAXqB,KAWHC,EAXG,eAkBpBwB,EACJ/B,EAAWF,QACX6B,EACArC,EACAU,EACAM,GAvBwB,oBAiBpB0B,EAjBoB,EAiBpBA,kBAAmBC,EAjBC,EAiBDA,aAAcC,EAjBb,EAiBaA,QAAS4B,EAjBtB,EAiBsBA,gBAS9CzC,EA1BwB,kCA4BnBN,EAA2Bf,EAAWE,MAAME,WA5BzB,eA2BpBY,EA3BoB,OA4BqC,GAC/DP,QAAQC,IACN,gBACApB,EAAae,UAAUgF,WACvBvB,GAhCwB,UAkCpB9D,EAAWF,QAAQqC,IAAIC,aAAa,IAAIjD,IAAU2E,GAAiB,CACvEzB,SAAU,CACR/B,mBACAN,WAAYA,EAAWoB,GACvBJ,0BAEAJ,SAAUZ,EAAWE,MAAMU,SAC3B0B,cAAenD,IAAYoD,cAAcC,UACzCC,MAAOtD,IAAYuD,oBACnBC,cAAe3C,EAAWE,MAAMiB,KAAKwB,eAEvCC,UAAW,CAAEC,aAAa,GAC1Bb,kBAAkB,CAChB,CACEV,OAAQhC,EAAae,UACrB2C,UAAU,EACVC,YAAY,IAJC,mBAMZjB,IAELE,UACAD,aAAcA,EAAaa,OAAS,EAAIb,OAAec,IAvD/B,2DA6D1BtC,QAAQC,IAAI,SAAUoD,GACtBrD,QAAQC,IAAIV,EAAWE,OA9DG,UA+DpBF,EAAWF,QAAQqC,IAAImD,eAC3B/E,EACA,IAAIpB,IAAU2E,GACd,CACEzB,SAAU,CACR/B,mBACAN,WAAYA,EAAWoB,GAEvBR,SAAUZ,EAAWE,MAAMU,SAC3B2C,MAAOjE,EAAae,UACpB+C,MAAO9D,EAAae,UACpBiC,cAAenD,IAAYoD,cAAcC,UACzC0C,KAAM/F,IAAYgG,mBAClB1C,MAAOtD,IAAYuD,oBACnBC,cAAe3C,EAAWE,MAAMiB,KAAKwB,eAGvCX,oBACAE,UACAD,aAAcA,EAAaa,OAAS,EAAIb,OAAec,IAlFjC,iEAsF1BtC,QAAQC,IAAR,MAtF0B,gEAAH,4D,gPCred6E,EAAwB,IAAIpG,IAAYC,UACnD,+CAGIoG,EAA4B,IAAIrG,IAAYC,UAChD,+CAsBWqG,EAAqC,uCAAG,WACnDC,EACAC,EACAnG,GAHmD,iCAAAC,EAAA,4FAId,SACrCmG,EALmD,gCAO/CC,GAAO,EACPC,EAAoD,CACtDC,KAAM,EACNC,cAAe,EACfC,IAAK,MAEHC,EAAQ,EAbuC,SAcpC,IAAIC,QAAJ,uCAAY,WAAOC,EAASC,GAAhB,SAAA5G,EAAA,sDACzB6G,YAAW,WACLT,IAGJA,GAAO,EACPpF,QAAQC,IAAI,4BACZ2F,EAAO,CAAEV,SAAS,OACjBA,GARsB,UASjBE,IAAQD,EATS,uBAWvB,sBAAC,4BAAAnG,EAAA,+EAEmCD,EAAW+G,qBAAqB,CAC9Db,IAHL,OAESc,EAFT,OAKGV,EAASU,GAAqBA,EAAkBC,MAAM,GACjDZ,IACEC,EAEMA,EAAOG,KAChBxF,QAAQC,IAAI,iBAAkBgF,EAAMI,GACpCD,GAAO,EACPQ,EAAOP,EAAOG,MACJH,EAAOE,eAGjBvF,QAAQC,IAAI,wBAAyBgF,EAAMI,GAC3CD,GAAO,EACPO,EAAQN,IAJRrF,QAAQC,IAAI,4BAA6BgF,EAAMI,GAN/CrF,QAAQC,IAAI,uBAAwBgF,EAAMI,IARjD,gDAsBQD,GACHpF,QAAQC,IAAI,8BAA+BgF,EAA3C,MAvBL,wDAAD,GAXuB,SAsCjBgB,EAAM,KAtCW,iEAAZ,yDAdoC,cAcnDZ,EAdmD,OAyD/CtG,EAAWmH,wBAAwBT,IACrC1G,EAAWoH,wBAAwBV,GAErCL,GAAO,EACPpF,QAAQC,IAAI,mBAAoBoF,GA7DmB,kBA8D5CA,GA9D4C,4CAAH,0DAiE/B3C,EAA0C,SAC3D0D,EACAzD,EACA0D,EACAC,GAEA,IAAMC,EAAO,CACX,CAAE1F,OAAQ8B,EAAOJ,UAAU,EAAMC,YAAY,GAC7C,CAAE3B,OAAQuF,EAAwB7D,UAAU,EAAOC,YAAY,GAC/D,CAAE3B,OAAQwF,EAAe9D,UAAU,EAAOC,YAAY,GACtD,CAAE3B,OAAQyF,EAAqB/D,UAAU,EAAOC,YAAY,GAC5D,CACE3B,OAAQnC,IAAYoD,cAAcC,UAClCQ,UAAU,EACVC,YAAY,GAEd,CAAE3B,OAAQgC,IAAkBN,UAAU,EAAOC,YAAY,GACzD,CACE3B,OAAQnC,IAAYgG,mBACpBnC,UAAU,EACVC,YAAY,IAGhB,OAAO,IAAI9D,IAAY8H,uBAAuB,CAC5CD,OACAxE,UAAW0E,IACX/F,KAAMsC,EAAOC,KAAK,OAITyD,EAAoB,uCAAG,WAClC7H,EACA8H,EACA5H,GAHkC,2BAAAC,EAAA,6DAK5BC,EAAW,IAAIP,IAAgBK,EAAYF,EAAc,CAC7DK,oBAAqB,WANW,SAShBR,IAAeS,SAAS2F,EAAuB7F,GAT/B,cAS5BG,EAT4B,OAW5BC,EAAU,IAAIX,IAAeU,EAAK0F,EAAuB7F,GAX7B,SAaTI,EAAQC,QAAQsH,aAAapH,MAAMmH,GAb1B,cAa5BlH,EAb4B,OAc5BoH,EAAiBpH,EAAMiB,KAAKmG,eAAexF,WAC3CyF,EAAgBrH,EAAMqH,cAAczF,WACpC0F,EAAiBF,EAAiBC,EAhBN,kBAkB3B,CACLnG,GAAIgG,EACJtH,UACAI,MAAO,CACLoH,iBACAC,gBACAC,iBACAC,UAA8B,IAAnBD,EACXE,SAAUxH,EAAMiB,KAAKwG,WAAW7F,YAAa,IAAI8F,MAAOC,UAAY,IACpEF,WAAYzH,EAAMiB,KAAKwG,WACvB/G,SAAUV,EAAM4H,OAChB1H,UAAWF,EAAME,UACjB2H,OAAQ7H,EAAM6H,OACdC,MAAO9H,EAAMiB,KAAK6G,SA/BY,4CAAH,0DAoC3BC,EAAgB,uCAAG,WACvBC,GADuB,SAAAzI,EAAA,sEAIfN,IAAYC,UAAUoE,mBAC1B,CACEC,EAAOC,KAAK,YACZ8B,EAA0B7B,WAC1BuE,EAAKvE,WACLF,EAAOC,KAAK,YAEd8B,GAXmB,uCAarB,IAbqB,2CAAH,sDAgBhB2C,EAAW,uCAAG,WAClBD,GADkB,SAAAzI,EAAA,sEAIVN,IAAYC,UAAUoE,mBAC1B,CACEC,EAAOC,KAAK,YACZ8B,EAA0B7B,WAC1BuE,EAAKvE,YAEP6B,GAVc,uCAYhB,IAZgB,2CAAH,sDAeJ4C,EAAY,uCAAG,WAC1Bf,EACAjE,GAF0B,iCAAA3D,EAAA,6DAIpByI,EAAO/I,IAAYkF,QAAQC,WAJP,SAOlB7C,YAAcyG,EAAK7H,UAAW+C,GAPZ,cAMpBiF,EANoB,OAQxB,GARwB,SAWlB5G,YAAc4F,EAAanH,MAAME,UAAWgD,GAX1B,cAUpBkF,EAVoB,OAYxB,GAEIC,EAAsBlB,EAAajG,GAEnCY,EAAoB,GACpBE,EAAiC,CAACgG,GAjBd,KAmBxB/I,IAAYoD,cAnBY,KAoBVa,EApBU,KAqBJ8E,EAAK7H,UArBD,KAsBfmI,IAAWC,KAtBI,UAwBdpB,EAAavH,QAAQJ,SAASF,WAAWkJ,kCAC7CF,IAAWC,MAzBO,gCA2BXnF,IA3BW,MAoBtBqF,WApBsB,KAqBtBC,iBArBsB,KAsBtBC,MAtBsB,KAuBtBC,SAvBsB,KA2BtBtG,UA3BsB,gBAmBEuG,cAnBF,qBA6BxBvE,IAAMwE,0BACJ1F,IACA4E,EAAK7H,UACL,EACA+C,EACAA,GAlCsB,KAoCxBD,EACEkF,EACAjF,EACAA,EACA8E,EAAK7H,WAxCiB,MA0CxBmE,IAAMyE,wBACJ3F,IACA4E,EAAK7H,UACLgI,EACAjF,EACA,GACA,GA9BEnB,EAlBoB,uBAqDtBoF,EAAanH,MAAME,YACfgE,EAAoBjF,IAAYkF,QAAQC,WAE9CpC,EAAQqC,KAAKH,GACbpC,EAAkBuC,KAAK,CACrBjD,OAAQgH,EACRrF,YAAY,EACZD,UAAU,IAEZhB,EAAkBuC,KAAK,CACrBjD,OAAQ8C,EAAkB/D,UAC1B4C,YAAY,EACZD,UAAU,IAGZf,EAAasC,KACXC,IAAMC,yBACJnB,IACAgF,EACAlE,EAAkB/D,UAClB+C,EACA,GACAiE,EAAanH,MAAM8H,MAAMlG,cA3EL,UA+EIqG,EAAYD,EAAK7H,WA/ErB,eA+EpB6I,EA/EoB,iBAgFEjB,EAAiBC,EAAK7H,WAhFxB,eAgFpB8I,EAhFoB,aAkF1BlH,EAlF0B,UAmFlBoF,EAAavH,QAAQkF,YAAYoE,QAAQ,CAC7C/G,SAAU,CACR0F,OAAQV,EAAanH,MAAM6H,OAC3BV,aAAckB,EACdnF,QACA0E,OAAQT,EAAanH,MAAMU,SAC3BsH,KAAMA,EAAK7H,UACXgJ,SAAUH,EACVC,gBACAG,cAAelG,EACfmG,gBAAiBnG,EACjBoG,qBAAsBhE,EACtBnC,aAAcC,IACdhB,cAAeC,gBAAcC,UAC7B0C,KAAM/F,IAAYgG,mBAClB1C,MAAOtD,IAAYuD,qBAErBV,kBACEA,EAAkBc,OAAS,EAAId,OAAoBe,IArG/B,kCAkFbwB,KAlFa,sCAqHhBkF,YACJpC,EAAavH,QAAQJ,SAASF,WAC9B6H,EAAavH,QAAQJ,SAASoI,OAC9B7F,EACAC,GAzHoB,wCA2HtBwD,MA3HsB,oCA6HxBjF,QAAQC,IAAR,OA7HwB,iCA+HnB,KA/HmB,2DAAH,wDAsInBgG,EAAQ,SAACgD,GACb,OAAO,IAAIvD,SAAQ,SAAAC,GAAO,OAAIE,WAAWF,EAASsD,S,oUCtUvCC,EAAyB,IAAIxK,IAAYC,UACpD,+CAGWwK,EAAS,SAACnD,GACrB,GAAKA,EAIL,OAAO,IAAImB,KAAwB,IAAnBnB,EAAM3E,aAGlB+H,EAAiB,IAAIC,KAAKC,aAAa,QAAS,CACpDC,MAAO,UACPC,sBAAuB,EACvBC,sBAAuB,IAGZC,EAAe,CAC1BC,OAAQ,SAACC,GACP,OAAKA,EAIER,EAAeO,OAAOC,GAHpB,MAKXC,SAAU,SAACD,GACT,GAAKA,EAIL,OAAOA,EAAIvI,WAAaoC,qBAIfgD,EACX,IAAI/H,IAAYC,UAAU,gDAEfwF,EAA4B,uCAAG,WAC1CxE,EACAyE,GAF0C,SAAApF,EAAA,sEAI7BN,IAAYC,UAAUoE,mBACjC,CACEC,EAAOC,KAAK,eACZtD,EAAUuD,WACVkB,EAAI0F,YAAY9G,EAAQ,KAAM,IAEhCkG,GAVwC,mFAAH,wDAc5BlI,EAAa,uCAAG,WAC3ByG,EACA3E,GAF2B,SAAA9D,EAAA,sEAIdN,IAAYC,UAAUoE,mBACjC,CAACD,EAAMI,WAAYL,IAAiBK,WAAYuE,EAAKvE,YACrDuD,GANyB,mFAAH,wDAoBnB,SAAS/D,EACd0D,EACAzD,EACA0D,EACAC,GAEA,IAAMC,EAAO,CACX,CACE1F,OAAQ8B,EACRJ,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQuF,EACR7D,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQwF,EACR9D,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQyF,EACR/D,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQiB,gBAAcC,UACtBQ,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQgC,IACRN,UAAU,EACVC,YAAY,GAEd,CACE3B,OAAQ6D,qBACRnC,UAAU,EACVC,YAAY,IAGhB,OAAO,IAAIgE,yBAAuB,CAChCD,OACAxE,UAAW0E,EACX/F,KAAMsC,EAAOC,KAAK,S,+FC1EV8G,E,yDAAAA,O,2BAAAA,I,uBAAAA,I,kCAAAA,M,KAoEL,IAkKMf,EAAwB,uCAAG,WACtCjK,EACAsI,EACA7F,EACAC,GAJsC,+CAAAzC,EAAA,yDAKtCgL,EALsC,+BAKb,eACzBC,EANsC,gCAOtCC,EAPsC,uBAQtCC,EARsC,uBAUjC9C,EAAOzH,UAV0B,sBAUT,IAAIwK,0BAVK,UAYlCC,EAAc,IAAIC,cACtB9I,EAAa+I,SAAQ,SAAAhG,GAAW,OAAI8F,EAAYG,IAAIjG,MAbd,KAepC2F,EAfoC,uCAepBnL,EAAW0L,mBAAmBT,GAfV,+BActCK,EAAYK,gBAd0B,KAgBpCC,UAEEV,GACF,EAAAI,GAAYO,WAAZ,oBAA0BnJ,EAAQoJ,KAAI,SAAAC,GAAC,OAAIA,EAAElL,gBAE7C,EAAAyK,GAAYO,WAAZ,SAEEvD,EAAOzH,WAFT,mBAGK6B,EAAQoJ,KAAI,SAAAC,GAAC,OAAIA,EAAElL,gBAItB6B,EAAQY,OAAS,IACnB,EAAAgI,GAAYU,YAAZ,oBAA2BtJ,IAExBwI,EA/BiC,kCAgChB5C,EAAO2D,gBAAgBX,GAhCP,QAgCpCA,EAhCoC,sBAmClCF,GACFA,IApCoC,UAuCTc,EAAsB,CACjDlM,aACAmM,kBAAmBb,IAzCiB,wBAuC9BpF,EAvC8B,EAuC9BA,KAAMK,EAvCwB,EAuCxBA,KAvCwB,kBA4C/B,CAAEL,OAAMK,SA5CuB,4CAAH,4DA+CxB6F,EAAY,WACvB,OAAO,IAAIhE,MAAOC,UAAY,KAG1BgE,EAAkB,KAEjB,SAAeH,EAAtB,kC,4CAAO,qDAAAjM,EAAA,6DACLkM,EADK,EACLA,kBACAnM,EAFK,EAELA,WAFK,IAGLmG,eAHK,MAGKkG,EAHL,EAYCC,EAAiBH,EAAkBI,YACnCC,EAAYJ,IACd7F,EAAO,EAdN,SAeoCvG,EAAWyM,mBAClDH,EACA,CACEI,eAAe,IAlBd,cAeCxG,EAfD,OAsBLjF,QAAQC,IAAI,oCAAqCgF,GAE7CG,GAAO,EACX,sBAAC,sBAAApG,EAAA,yDACSoG,KAAQ+F,IAAcI,EAAYrG,GAD3C,uBAEGnG,EAAWyM,mBAAmBH,EAAgB,CAC5CI,eAAe,IAHpB,SAKSxF,EAAM,KALf,gEAAD,GAzBK,oBAkCwBjB,EACzBC,EACAC,EACAnG,EACA,UACA,GAvCC,WAkCG2M,EAlCH,8BA2CK,IAAIC,MAAM,kDA3Cf,YA6CCD,EAAalG,IA7Cd,uBA8CDxF,QAAQ4L,MAAMF,EAAalG,KACrB,IAAImG,MAAM,gDA/Cf,QAkDHrG,GAAmB,OAAZoG,QAAY,IAAZA,OAAA,EAAAA,EAAcpG,OAAQ,EAlD1B,sDAoDHtF,QAAQ4L,MAAM,uBAAd,OACI,KAAI1G,QArDL,uBAsDK,IAAIyG,MAAM,kDAtDf,eAwDCE,EAAsD,KAxDvD,oBA2DOC,EAAoB/M,EAAYmM,EAAmB,UA3D1D,QA0DDW,EA1DC,OA4DC7F,MA5DD,+DA8DC6F,IAAkBA,EAAerG,IA9DlC,qBA+DGqG,EAAeE,KA/DlB,iBAgEUC,EAAIH,EAAeE,KAAK1J,OAAS,EAhE3C,aAgE8C2J,GAAK,GAhEnD,sBAiESC,EAAOJ,EAAeE,KAAKC,IACxBE,WAAW,iBAlEvB,uBAmEW,IAAIP,MACR,uBAAyBM,EAAKE,MAAM,gBAAgB9J,SApE3D,UAgEwD2J,EAhExD,8BAyEK,IAAIL,MAAMS,KAAKC,UAAUR,EAAerG,MAzE7C,yBA6EHJ,GAAO,EA7EJ,4BAgFLpF,QAAQC,IAAI,UAAWgF,EAAMkG,IAAcI,GAhFtC,kBAiFE,CAAEtG,OAAMK,SAjFV,0E,+BAoFQwG,E,kFAAf,WACE/M,EACAsL,EACAL,GAHF,uBAAAhL,EAAA,sEAMsCD,EAAWuN,iBAE7CvN,EAAWwN,0BARf,cAMElC,EAAYK,gBANd,OAWQ8B,EAAWnC,EAAYoC,mBAEvBC,EAAkBrC,EAAYsC,WAAWH,GACzCI,EAAqBF,EAAgBG,SAAS,UAE9CC,EAAO,CAACF,EADM,CAAEG,SAAU,SAAU/C,eAf5C,UAmBoBjL,EAAWiO,YAAY,sBAAuBF,GAnBlE,aAmBQG,EAnBR,QAoBUrB,MApBV,uBAqBU,IAAID,MAAM,mCAAqCsB,EAAIrB,MAAMsB,SArBnE,iCAuBSD,EAAIE,QAvBb,6C,+BA0BenI,E,kFAAf,WACEC,EACAC,EACAnG,GAHF,mCAAAC,EAAA,6DAIEgL,EAJF,+BAI2B,SACzB7E,EALF,gCAOMC,GAAO,EACPC,EAAwC,CAC1CC,KAAM,EACNC,cAAe,EACfC,IAAK,MAEHC,EAAQ,EAbd,SAciB,IAAIC,QAAJ,uCAAY,WAAOC,EAASC,GAAhB,SAAA5G,EAAA,sDACzB6G,YAAW,WACLT,IAGJA,GAAO,EACPpF,QAAQC,IAAI,4BACZ2F,EAAO,CAAEV,SAAS,OACjBA,GACH,IACEO,EAAQ1G,EAAWqO,YACjBnI,GACA,SAACkI,EAAQE,GACPjI,GAAO,EACPC,EAAS,CACPG,IAAK2H,EAAO3H,IACZF,KAAM+H,EAAQ/H,KACdC,cAAe,GAEb4H,EAAO3H,KACTxF,QAAQC,IAAI,yBAA0BkN,EAAO3H,KAC7CI,EAAOP,KAEPrF,QAAQC,IAAI,yBAA0BkN,GACtCxH,EAAQN,MAGZ2E,GAEF,MAAOsD,GACPlI,GAAO,EACPpF,QAAQ4L,MAAM,oBAAqB3G,EAAMqI,GA/BlB,UAiCjBlI,IAAQD,EAjCS,uBAmCvB,sBAAC,4BAAAnG,EAAA,+EAEmCD,EAAW+G,qBAAqB,CAC9Db,IAHL,OAESc,EAFT,OAKGV,EAASU,GAAqBA,EAAkBC,MAAM,GACjDZ,IACEC,EAEMA,EAAOG,KAChBxF,QAAQC,IAAI,iBAAkBgF,EAAMI,GACpCD,GAAO,EACPQ,EAAOP,EAAOG,MACJH,EAAOE,eAGjBvF,QAAQC,IAAI,wBAAyBgF,EAAMI,GAC3CD,GAAO,EACPO,EAAQN,IAJRrF,QAAQC,IAAI,4BAA6BgF,EAAMI,GAN/CrF,QAAQC,IAAI,uBAAwBgF,EAAMI,IARjD,gDAsBQD,GACHpF,QAAQC,IAAI,8BAA+BgF,EAA3C,MAvBL,wDAAD,GAnCuB,SA8DjBgB,EAAM,KA9DW,iEAAZ,yDAdjB,cAcEZ,EAdF,OAiFMtG,EAAWmH,wBAAwBT,IACrC1G,EAAWoH,wBAAwBV,GACrCL,GAAO,EACPpF,QAAQC,IAAI,mBAAoBoF,GApFlC,kBAqFSA,GArFT,4C,wBAuFO,SAASY,EAAMgD,GACpB,OAAO,IAAIvD,SAAQ,SAAAC,GAAO,OAAIE,WAAWF,EAASsD,Q,8tBC5Z/CsE,E,+OCrHCC,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,KAAM,CACJC,QAAS,OACTC,QAASJ,EAAMK,QAAQ,GACvB,QAAS,CACPC,OAAQN,EAAMK,QAAQ,IACtBE,YAAa,EACbC,MAAOR,EAAMK,QAAQ,GACrBI,OAAQT,EAAMK,QAAQ,GACtBF,QAAS,OACTO,cAAe,SACfC,aAAc,SACdC,WAAY,SACZC,eAAgB,SAChBC,WAAY,UACZC,MAAO,QACPC,aAAc,EACdC,SAAU,KAGdvJ,KAAM,CACJyI,QAAS,OACTG,OAAQN,EAAMK,QAAQ,GACtBE,YAAa,EACbH,QAASJ,EAAMK,QAAQ,GACvBK,cAAe,SACfC,aAAc,SACdC,WAAY,SACZC,eAAgB,SAChBC,WAAY,UACZC,MAAO,QACPC,aAAc,EACdE,WAAY,OACZD,SAAU,IAEZE,KAAM,CACJD,WAAY,OACZD,SAAU,SAuBHG,EAAgD,SAAC,GAOvD,IANLC,EAMI,EANJA,KACA1J,EAKI,EALJA,OACAkE,EAII,EAJJA,MACAyF,EAGI,EAHJA,MACAC,EAEI,EAFJA,IACAC,EACI,EADJA,WAEMC,EAAU3B,IAEhB,EAA8B4B,sBAASJ,GAASC,GAAOF,IAAOC,EAAM5H,UAAYD,KAAKkI,MAAQ,GAA7F,mBAAOC,EAAP,KAEMC,GAFN,KAEwB,SAAC,GAAmE,IAAjEC,EAAgE,EAAhEA,KAAMC,EAA0D,EAA1DA,MAAOC,EAAmD,EAAnDA,QAASC,EAA0C,EAA1CA,QAE/C,OADAF,GAAgB,GAAPD,EADgF,EAAjCI,UAG/CvK,EAAS,sBAAMwK,UAAWV,EAAQ/J,KAAzB,SAAkCC,IAAiB,KAGjE,sBAAKwK,UAAWV,EAAQvB,KAAMrE,MAAOA,EAArC,UACG+F,GAAW,cAACQ,EAAA,EAAD,CAAOC,UAAW,EAAlB,SACV,sBAAMF,UAAWV,EAAQN,KAAzB,iBAIF,eAACiB,EAAA,EAAD,CAAOC,UAAW,EAAlB,UACE,sBAAMF,UAAWV,EAAQN,KAAzB,SACGY,EAAQ,GAAR,WAAiBA,GAAUA,IAE9B,0CAEF,eAACK,EAAA,EAAD,CAAOC,UAAW,EAAlB,UACE,sBAAMF,UAAWV,EAAQN,KAAzB,SACGa,EAAU,GAAV,WAAmBA,GAAYA,IAElC,2CAEF,eAACI,EAAA,EAAD,CAAOC,UAAW,EAAlB,UACE,sBAAMF,UAAWV,EAAQN,KAAzB,SACGc,EAAU,GAAV,WAAmBA,GAAYA,IAElC,gDAkBV,OAXIZ,GAAQC,GAASC,GACfK,GACD,IASDP,EAEA,cAAC,IAAD,CACEA,KAAMA,EACNG,WAAYA,EACZc,SAAUT,IAIP,M,0GDrFLU,EAAgBC,YAAOC,qBAAPD,CAAH,sOAWbE,EAAgBF,IAAOG,IAAV,0BAEbC,EAAaJ,YAAOK,IAAPL,CAAH,sOAWVM,EAAoB,SAAC9C,GAAD,OACxBC,YAAa,CACXC,KAAM,CACJI,OAAQ,EACRF,QAASJ,EAAMK,QAAQ,IAEzB0C,YAAa,CACXC,SAAU,WACVC,MAAOjD,EAAMK,QAAQ,GACrB6C,IAAKlD,EAAMK,QAAQ,GACnBU,MAAOf,EAAMmD,QAAQC,KAAK,SAI1BC,EAAcb,YAAOc,IAAPd,CAAe,CACjCzB,MAAO,UACPN,OAAQ,EACR,QAAS,CACPA,OAAQ,GAEV,qBAAsB,CACpB8C,OAAQ,OACR9C,OAAQ,GAEV,qBAAsB,CACpBA,OAAQ,GACRD,MAAO,GACPgD,WAAY,GACZ1C,WAAY,oDACZyC,OAAQ,yBACR,qDAAsD,CACpDE,UAAW,WAEb,WAAY,CACVtD,QAAS,SAGb,0BAA2B,CACzB,QAAS,CACPW,WAAY,qDAEd4C,WAAY,IACZzC,SAAU,GACVb,QAAS,EACTI,MAAO,GACPC,OAAQ,GACRkD,WAAY,M,SAIX9D,O,mBAAAA,I,mBAAAA,I,mBAAAA,I,qBAAAA,I,mBAAAA,I,mBAAAA,I,sBAAAA,M,KAUL,IAAM+D,EAAS,SAACC,GAMd,IAAQC,EAAkCD,EAAlCC,UAAWC,EAAuBF,EAAvBE,KAAM1C,EAAiBwC,EAAjBxC,KAAM1J,EAAWkM,EAAXlM,OAC/B,OACE,eAACqM,EAAA,EAAD,CAAMC,WAAS,EAACpD,eAAe,SAA/B,UACE,eAACmD,EAAA,EAAD,CAAME,GAAI,EAAGrD,eAAe,SAASsD,UAAU,SAA/C,UACE,cAACC,EAAA,EAAD,CAAYC,QAAQ,KAAKxI,MAAO,CAAEqF,WAAY,KAA9C,SACG4C,IAEH,cAACM,EAAA,EAAD,CAAYC,QAAQ,QAAQtD,MAAM,gBAAlC,SACGgD,OAGL,cAACC,EAAA,EAAD,CAAME,GAAI,EAAGD,WAAS,EAACpD,eAAe,WAAtC,SACE,cAAC,EAAD,CACEQ,KAAM5F,YAAO4F,GACbxF,MAAO,CAAEgF,eAAgB,YACzBlJ,OAAQA,GAAU,mBAO5B,SAAS2M,EACPzS,EACAqH,GACQ,IAAD,QACDqL,GAAO,IAAI9K,MAAOC,UAElB8K,EAAQ,UAAG/I,YAAM,OAAC5J,QAAD,IAACA,OAAD,EAACA,EAAYE,MAAMiB,KAAKyR,sBAAjC,aAAG,EAA8C/K,UACzDgL,EAAW,UAAGjJ,YAAM,OAAC5J,QAAD,IAACA,OAAD,EAACA,EAAYE,MAAMiB,KAAK0R,oBAAjC,aAAG,EAA4ChL,UAC1DiL,EAAW,UAAGlJ,YAAM,OAAC5J,QAAD,IAACA,OAAD,EAACA,EAAYE,MAAMiB,KAAK2R,oBAAjC,aAAG,EAA4CjL,UAC1DkL,EAAkB,UAAGnJ,YAAM,OAACvC,QAAD,IAACA,OAAD,EAACA,EAAcnH,MAAMyH,mBAA9B,aAAG,EAAwCE,UACnE,OAAI8K,GAAYD,EAAOC,EACd3E,EAAMgF,OACJH,GAAeH,GAAQG,EACzB7E,EAAMiF,OACJH,GAAeJ,GAAQI,EACzB9E,EAAMkF,SAEb,OAAClT,QAAD,IAACA,OAAD,EAACA,EAAYE,MAAMiT,oBACnBL,GACAJ,EAAOI,EAEA9E,EAAMoF,SAEH,OAAVpT,QAAU,IAAVA,OAAA,EAAAA,EAAYE,MAAMiT,oBAClBJ,GACAL,EAAOK,EAEA/E,EAAMqF,QACR,OAAIrT,QAAJ,IAAIA,OAAJ,EAAIA,EAAYE,MAAMiT,mBACpBnF,EAAMsF,OAERtF,EAAMuF,QAWf,IAMMC,GAAW,SAACxT,GAAwD,IAAD,MACvE,KACE,OAACA,QAAD,IAACA,OAAD,EAACA,EAAYuB,QAAQJ,SACrB,OAACnB,QAAD,IAACA,OAAD,EAACA,EAAYuB,QAAQJ,KAAK2B,WAC1B,OAAC9C,QAAD,IAACA,GAAD,UAACA,EAAYqB,OAAOF,YAApB,aAAC,EAAyB0D,QAC1B,OAAC7E,QAAD,IAACA,OAAD,EAACA,EAAYE,MAAMiT,mBAEnB,OAAO,EAGT,IAAMM,EACJzT,EAAWuB,QAAQJ,KAhBrB,GAkBM6C,KAAK0P,OAAM,UAAA1T,EAAWqB,OAAOF,YAAlB,eAAwB0D,IAAI/C,YAAa,IAGpD6R,EAAoB,GAAK,UAAA3T,EAAWqB,OAAOF,YAAlB,eAAwB0D,IAAI/C,YAAa,EAElE0R,EAAWC,EADJzP,KAAK4P,IAAI,EAAGD,GAEzB,OAAOH,EAAW,GA4/BLK,GAz/BF,SAAC7B,GAAsB,IAAD,qGACjC,GAAkDnC,mBAAiB,GAAnE,qBAAOiE,GAAP,MAA0BC,GAA1B,MACA,GAA4ClE,mBAAwB,MAApE,qBAAOmE,GAAP,MAAuBC,GAAvB,MAEA,GAAkCpE,oBAAS,GAA3C,qBAAOqE,GAAP,MAAkBC,GAAlB,MACA,GAAsCtE,mBAAS,GAA/C,qBAAOuE,GAAP,MAAoBC,GAApB,MAEMvM,GAASwM,sBAEThV,GAAeiV,mBAAQ,WAC3B,GACGzM,IACAA,GAAOzH,WACPyH,GAAO0M,qBACP1M,GAAO2D,gBAKV,MAAO,CACLpL,UAAWyH,GAAOzH,UAClBmU,oBAAqB1M,GAAO0M,oBAC5B/I,gBAAiB3D,GAAO2D,mBAEzB,CAAC3D,KAEJ,GAAoC+H,mBAAqB,CACvD4E,MAAM,EACN9G,QAAS,GACT+G,cAAU3R,IAHZ,qBAAO4R,GAAP,MAAmBC,GAAnB,MAMA,GAAoC/E,qBAApC,qBAAO7P,GAAP,MAAmB6U,GAAnB,MACA,GAAwChF,qBAAxC,qBAAOxI,GAAP,MAAqByN,GAArB,MACA,GAAkCjF,oBAAS,GAA3C,qBAAOkF,GAAP,MAAkBC,GAAlB,MACA,GAAsDnF,oBAAS,GAA/D,qBAAOoF,GAAP,MAA4BC,GAA5B,MACA,GAAkDrF,oBAAS,GAA3D,qBAAOsF,GAAP,MAA0BC,GAA1B,MAEMC,GAAM,uCAAG,kCAAA5V,EAAA,kEAEX0U,IAAa,KACTrM,GAAOwN,YAAP,OAAoBjO,SAApB,IAAoBA,QAApB,EAAoBA,GAAcvH,UAAWgI,GAAOzH,WAH7C,sBAIK,OAAVL,SAAU,IAAVA,IAAA,UAAAA,GAAYqB,OAAOF,YAAnB,eAAyBjB,MAAMqV,aAAa/B,GAASxT,IAJhD,gCAKDwV,KALC,uBAQcpN,YAAaf,GAAcS,GAAOzH,WARhD,cAQHoV,EARG,iBAUYhQ,YACnBgQ,EACAzD,EAAM0D,UACN1D,EAAMxS,WACN,gBACA,GAfO,SAkBL,QAREsG,EAVG,cAkBL,IAACA,OAAD,EAACA,EAAQG,KAOX2O,GAAc,CACZH,MAAM,EACN9G,QAAS,iCACT+G,SAAU,UATZE,GAAc,CACZH,MAAM,EACN9G,QAAS,mCACT+G,SAAU,YAtBL,0DAkCP/G,EAAU,KAAMgI,KAAO,oCACtB,KAAMA,IAUU,MAAf,KAAMC,MACRjI,EAAO,YACPkI,OAAOC,SAASC,UACQ,MAAf,KAAMH,OACfjI,EAAO,sCAbJ,KAAMA,QAEA,KAAMA,QAAQqI,QAAQ,WACtB,KAAMrI,QAAQqI,QAAQ,SAC/BrI,EAAO,YACE,KAAMA,QAAQqI,QAAQ,WAC/BrI,EAAO,yDALPA,EAAU,yCAgBdiH,GAAc,CACZH,MAAM,EACN9G,UACA+G,SAAU,UAxDD,yBA2DXP,IAAa,GA3DF,6EAAH,qDA+DZ8B,qBAAU,WACR,sBAAC,sCAAAxW,EAAA,yDACMH,GADN,0EAMyB0S,EAAMxS,WAAWmB,WACrCrB,GAAae,WAPlB,cAMS6V,EANT,OASGjC,GAAkBiC,GATrB,SAWuB7W,YAClBC,GACA0S,EAAMzS,aACNyS,EAAMxS,YAdX,UAWSU,EAXT,OAiBG2U,GAAc3U,GAjBjB,WAoBSA,EAAMA,MAAME,UApBrB,6BAsBe4R,EAAMxS,WAtBrB,UAwBmBiC,YACJvB,EAAMA,MAAME,UACZd,GAAae,WA1B5B,2BA4Ba,GA5Bb,eAsBgC8V,uBAtBhC,yBAqBarC,EArBb,QA+B6BrN,OACpBsN,GAAqBD,EAAkBrN,MAAM2P,UAAY,GAhClE,2DAoCK3V,QAAQC,IAAI,6CACZD,QAAQC,IAAR,MArCL,QAuCuB,IAAhB0T,KACY3B,EAASvS,OAAO6C,KAEhBiL,EAAMiF,QACZoD,GACHnW,EAAMA,MAAMiB,KAAKmV,cAAcxU,WAC9B5B,EAAMA,MAAMiB,KAAKgD,gBAAgBrC,YACnC5B,EAAMA,MAAMiB,KAAKoV,SAASzU,WACtB0U,EAAaxS,KAAKyS,MAAMzS,KAAK0S,SAAWL,GAE9ChC,IACGnU,EAAMA,MAAMiB,KAAKgD,gBAAgBrC,WAChC0U,EAAatW,EAAMA,MAAMiB,KAAKoV,SAASzU,YACvCoC,qBAGJmQ,IAEInU,EAAMA,MAAM2B,eAAiB3B,EAAMA,MAAMiB,KAAKgD,iBAC9CrC,WAAaoC,qBA1DxB,kDA+DGzD,QAAQC,IAAI,qCACZD,QAAQC,IAAR,MAhEH,YAkEKsR,EAAM5K,eAlEX,4CAoEwBD,YACjB7H,GACA0S,EAAM5K,eACN4K,EAAMxS,YAvEb,QAoEWmX,EApEX,OAyEK7B,GAAgB6B,GAzErB,mDA2EKlW,QAAQC,IAAI,uCACZD,QAAQC,IAAR,MA5EL,gCA+EGD,QAAQC,IAAI,+CA/Ef,yEAAD,KAkFC,CACDpB,GACA0S,EAAM5K,eACN4K,EAAMxS,WACNwS,EAAMzS,aACN6U,KAGF,IAAMwC,GAAMzM,IAAaG,SAAb,OAAsBtK,SAAtB,IAAsBA,QAAtB,EAAsBA,GAAYE,MAAMiB,KAAKgD,iBACnD0S,GAAM1M,IAAaG,SAAb,OAAsBtK,SAAtB,IAAsBA,QAAtB,EAAsBA,GAAYE,MAAMiB,KAAKmV,eACnDQ,GAAO3M,IAAaG,SAAb,OAAsBtK,SAAtB,IAAsBA,QAAtB,EAAsBA,GAAYE,MAAMiB,KAAKoV,UACpDQ,GAAS5M,IAAaG,SAAb,OAAsBtK,SAAtB,IAAsBA,QAAtB,EAAsBA,GAAYE,MAAM2B,eACjDmV,GAAQvE,EAASzS,GAAYqH,IACnC5G,QAAQC,IAAI,QAASsW,IACrB,IAAMC,GAAQ,CACZ,CACExQ,MAAOmQ,IAAO,EACdM,MAAM,GAAD,OAAKN,GAAL,UAHK,mBAMRI,KAAUhJ,EAAMiF,OAChB,GACA,CACE,CACExM,MAAOsQ,IAAU,EACjBG,MAAM,GAAD,OAAKH,OAXN,CAmBZ,CACEtQ,MAAOoQ,IAAO,EACdK,MAAM,GAAD,OAAKL,GAAL,WAEPM,QAAO,SAAAC,GAAC,YAAUrU,IAANqU,GAA+B,IAAZA,EAAE3Q,SAE7B4Q,GAAS,uCAAG,sBAAA5X,EAAA,yDACXH,GADW,wDAKhBmB,QAAQC,IAAI,WACZyT,IAAa,GANG,kBAQR7O,YAAe8O,GAAa9U,GAAcU,IARlC,OASdmU,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAQ,wBAAD,QACK,OAAV3N,SAAU,IAAVA,QAAA,EAAAA,GAAYqB,OAAOF,MAAO,UAAY,WADjC,KAGPuT,SAAU,YAfE,kDAkBdjU,QAAQC,IAAR,MACAyT,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAS,wBACT+G,SAAU,UAvBE,0DAAH,qDA2BT4C,GAAW,uCAAG,sBAAA7X,EAAA,yDACbH,GADa,wDAKlBmB,QAAQC,IAAI,UALM,SAOhByT,IAAa,GAPG,SAQV/O,YAAc9F,GAAcU,IARlB,OAShBmU,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QACE,+EACF+G,SAAU,YAdI,kDAiBhBjU,QAAQC,IAAR,MACAyT,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAS,wBACT+G,SAAU,UAtBI,0DAAH,qDA0BX6C,GAAc,uCAAG,sBAAA9X,EAAA,yDAChBH,GADgB,wDAKrBmB,QAAQC,IAAI,UALS,SAOnByT,IAAa,GAPM,SAQb7O,YAAe,EAAGhG,GAAcU,IARnB,OASnBmU,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QACE,oEACF+G,SAAU,YAdO,kDAiBnBjU,QAAQC,IAAR,MACAyT,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAS,wBACT+G,SAAU,UAtBO,0DAAH,qDA2Bdc,GAAa,uCAAG,sBAAA/V,EAAA,yDACfH,IAAiBU,IAAeA,GAAWqB,OAD5B,wDAKpBZ,QAAQC,IAAI,SACZyT,IAAa,GANO,kBAQZ3S,YAAYlC,GAAcU,IARd,OASlBmU,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAS,mCACT+G,SAAU,YAbM,kDAgBlBjU,QAAQC,IAAR,MACAyT,IAAa,GACbS,GAAc,CACZH,MAAM,EACN9G,QAAS,wBACT+G,SAAU,UArBM,0DAAH,qDA0Bb8C,IACQ,OAAZnQ,SAAY,IAAZA,QAAA,EAAAA,GAAcnH,MAAMyH,cAApB,OACA3H,SADA,IACAA,QADA,EACAA,GAAYE,MAAMiB,KAAK2R,eADvB,OAEAzL,SAFA,IAEAA,QAFA,EAEAA,GAAcnH,MAAMyH,WAAW8P,GAA/B,OAAkCzX,SAAlC,IAAkCA,QAAlC,EAAkCA,GAAYE,MAAMiB,KAAK2R,cAErD4E,MACc,MAAlB1D,KAAA,OACAhU,SADA,IACAA,QADA,EACAA,GAAYE,MAAMiB,KAAKgD,mBADvB,OAEAnE,SAFA,IAEAA,QAFA,EAEAA,GAAYE,MAAMiB,KAAKwW,MACvB3D,KAA4B,OAAVhU,SAAU,IAAVA,IAAA,UAAAA,GAAYqB,cAAZ,mBAAoBF,YAApB,eAA0BQ,OAAOG,aAAc,GAC/DsS,GAAclQ,oBAAd,OACElE,SADF,IACEA,QADF,EACEA,GAAYE,MAAMiB,KAAKwW,IAAI7V,YAC3B,KAGN,OACE,eAAC8V,EAAA,EAAD,CAAW5N,MAAO,CAAE2H,UAAW,KAA/B,UACE,cAACiG,EAAA,EAAD,CAAWC,SAAS,KAAK7N,MAAO,CAAEmH,SAAU,YAA5C,SACE,qBACEnH,MAAO,CACLsE,QAAS,OACTO,cAAe,MACfG,eAAgB,gBAKtB,cAAC4I,EAAA,EAAD,CAAWC,SAAS,KAAK7N,MAAO,CAAEmH,SAAU,YAA5C,SACE,cAACZ,EAAA,EAAD,CACEvG,MAAO,CAAEuE,QAAS,GAAIuJ,gBAAiB,UAAW3I,aAAc,GADlE,SAGE,eAACgD,EAAA,EAAD,CAAMC,WAAS,EAACpD,eAAe,SAASsD,UAAU,SAAlD,UACE,cAACC,EAAA,EAAD,0PAMCyE,KAAUhJ,EAAMgF,QACf,cAAC,EAAD,CACEf,UAAW,UACXC,KAAM,qBACN1C,KAAI,OAAExP,SAAF,IAAEA,QAAF,EAAEA,GAAYE,MAAMiB,KAAKyR,gBAGhCoE,KAAUhJ,EAAMiF,QACf,cAAC,EAAD,CACEhB,UAAW,UACXC,KAAM,kBACN1C,KAAI,OAAExP,SAAF,IAAEA,QAAF,EAAEA,GAAYE,MAAMiB,KAAK0R,cAIhCmE,KAAUhJ,EAAMkF,QACf,cAAC,EAAD,CACEjB,UAAW,UACXC,KAAM,eACN1C,KAAI,OAAExP,SAAF,IAAEA,QAAF,EAAEA,GAAYE,MAAMiB,KAAK2R,cAIhCkE,KAAUhJ,EAAMoF,SACf,cAAC,EAAD,CACEnB,UAAW,UACXC,KAAM,qBACN1C,KAAI,OAAExP,SAAF,IAAEA,QAAF,EAAEA,GAAYE,MAAMiB,KAAK2R,YAAY7H,IAAnC,OACJjL,SADI,IACJA,QADI,EACJA,GAAYE,MAAMiB,KAAK4W,mBAK5Bf,KAAUhJ,EAAMsF,SAAWjM,IAC1B,cAAC,EAAD,CACE4K,UAAW,UACXC,KAAM,mBACN1C,KAAI,OAAExP,SAAF,IAAEA,QAAF,EAAEA,GAAYE,MAAMiB,KAAK2R,cAIhCkE,KAAUhJ,EAAMsF,QAAUjM,IACzB,cAAC,EAAD,CACE4K,UAAW,UACXC,KAAM,uBACN1C,KAAI,OAAEnI,SAAF,IAAEA,QAAF,EAAEA,GAAcnH,MAAMyH,aAI7BqP,KAAUhJ,EAAMuF,UAAYlM,IAC3B,cAAC,EAAD,CACE4K,UAAW,aACXC,KAAM,0CACN1C,UAAMzM,IAITiU,KAAUhJ,EAAMqF,QACf,cAAC,EAAD,CACEpB,UACEuF,GAAiC,UAAY,UAE/CtF,KAAM,oDACN1C,KAAI,OAAEnI,SAAF,IAAEA,QAAF,EAAEA,GAAcnH,MAAMyH,WAC1B7B,OAAO,SAIV9F,IACC,cAACmS,EAAA,EAAD,CACEC,WAAS,EACTE,UAAU,SACVtD,eAAe,SACfD,WAAW,SACX/E,MAAO,CACL4E,OAAQ,IACR+C,UAAW,GACXqG,aAAc,GACd/I,WAAY,UACZE,aAAc,GAVlB,SAaGnP,GAAWqB,OAAOF,KACjB,qCACE,cAACoR,EAAA,EAAD,uBACA,eAACA,EAAA,EAAD,CAAYC,QAAQ,KAAKxI,MAAO,CAAEqF,WAAY,KAA9C,UACGlF,IAAaC,SACD,OAAVpK,SAAU,IAAVA,IAAA,UAAAA,GAAYqB,OAAOF,YAAnB,eAAyBQ,OAAOG,aAAc,GAC7CoC,oBACD,IAJL,YAQA,CAAC8J,EAAMgF,OAAQhF,EAAMiF,QAAQgF,SAASjB,IACxC,eAACzE,EAAA,EAAD,yMAG8D,wBACjD,OAAVvS,SAAU,IAAVA,IAAA,UAAAA,GAAYE,aAAZ,mBAAmBiB,YAAnB,eAAyBwW,MACxB,+BACE,qEACkC,KACrB,OAAV3X,SAAU,IAAVA,IAAA,UAAAA,GAAYE,aAAZ,mBAAmBiB,YAAnB,eAAyBwW,IAAI7V,YAC5BoC,mBAAkB,IAHtB,eAUN,cAACqO,EAAA,EAAD,uDAOLvS,IACC,qCACG,CACCgO,EAAMiF,OACNjF,EAAMkF,OACNlF,EAAMsF,OACNtF,EAAMoF,SACN6E,SAASjB,MALV,OAMChX,SAND,IAMCA,IAND,UAMCA,GAAYqB,cANb,iBAMC,EAAoBF,YANrB,aAMC,EAA0BjB,MAAMgY,YAC9B,qBAAKlO,MAAO,CAAEmO,WAAY,QAA1B,SACE,cAACC,EAAA,EAAD,CAAO1D,SAAS,QAAhB,6EAML,CAAC1G,EAAMkF,QAAQ+E,SAASjB,KACvBhX,GAAWE,MAAM2B,gBADlB,OAEC7B,SAFD,IAECA,IAFD,UAECA,GAAYqB,cAFb,iBAEC,EAAoBF,YAFrB,aAEC,EAA0BQ,WAC1B,OAAC3B,SAAD,IAACA,IAAD,UAACA,GAAYqB,cAAb,iBAAC,EAAoBF,YAArB,aAAC,EAA0BjB,MAAMgY,YACjClY,GAAWE,MAAM2B,cAAcD,GAA/B,OACE5B,SADF,IACEA,IADF,UACEA,GAAYqB,cADd,iBACE,EAAoBF,YADtB,aACE,EAA0BQ,SAE1B,qBAAKqI,MAAO,CAAEmO,WAAY,QAA1B,SACE,cAACC,EAAA,EAAD,CAAO1D,SAAS,UAAhB,+FAML,CAAC1G,EAAMsF,OAAQtF,EAAMoF,SAAS6E,SAASjB,KACtChX,GAAWE,MAAM2B,gBADlB,OAEC7B,SAFD,IAECA,IAFD,UAECA,GAAYqB,cAFb,iBAEC,EAAoBF,YAFrB,aAEC,EAA0BQ,WAC1B,OAAC3B,SAAD,IAACA,IAAD,UAACA,GAAYqB,cAAb,iBAAC,EAAoBF,YAArB,aAAC,EAA0BjB,MAAMgY,YACjClY,GAAWE,MAAM2B,cAAcD,GAA/B,OACE5B,SADF,IACEA,IADF,WACEA,GAAYqB,cADd,mBACE,GAAoBF,YADtB,cACE,GAA0BQ,SAE1B,qBAAKqI,MAAO,CAAEmO,WAAY,QAA1B,SACE,eAACC,EAAA,EAAD,CAAO1D,SAAS,QAAhB,6FAE4B,0CAF5B,iIAQLgD,IACC,cAACU,EAAA,EAAD,CAAO1D,SAAS,QAAhB,8EAQL,CAAC1G,EAAMiF,OAAQjF,EAAMkF,QAAQ+E,SAASjB,KACrC,mCACE,cAAC7E,EAAA,EAAD,CAAMnI,MAAO,CAAE2H,UAAW,GAAIqG,aAAc,IAA5C,SACG5D,GAAc,EACb,cAAC5C,EAAD,CACEoF,IAAKA,GACLK,MAAOA,GACPJ,IAAKA,GACLC,KAAMA,GACNrQ,MAAO2N,GACPiE,SAAU,SAACC,EAAIjO,GAAL,OAAagK,GAAehK,IACtCkO,kBAAkB,OAClBvO,MAAO,CACL2E,MAAO,oBACPmD,WAAY,GACZlD,OAAQ,MAIZ,qBACE5E,MAAO,CACLsE,QAAS,OACTU,eAAgB,SAChBD,WAAY,UAJhB,SAOE,cAACyJ,EAAA,EAAD,UAOR1Q,GAAOwN,UAMP,gCACG,CAACtH,EAAMiF,OAAQjF,EAAMkF,QAAQ+E,SAASjB,KACrC,mCACE,cAACjG,EAAD,CACE0H,QAASpB,GACT7E,QAAQ,YACRkG,SACExE,MACC,OAAClU,SAAD,IAACA,QAAD,EAACA,GAAYqB,OAAOF,OAAQ6V,KAAUhJ,EAAMkF,QAC7CwE,GANJ,SASGxD,GACC,cAACsE,EAAA,EAAD,KACE,OAACxY,SAAD,IAACA,QAAD,EAACA,GAAYqB,OAAOF,MAGtB,aAFA,gBASP,CAAC6M,EAAMsF,QAAQ2E,SAASjB,KACvB,qCACGxD,GAASxT,KACR,cAAC+Q,EAAD,CACE0H,QAASjD,GACThD,QAAQ,YACRkG,cAC6C3V,KAAjC,OAAV/C,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,OAAOF,YAAnB,iBAAyBjB,MAAMyY,SAJnC,SAOGzE,GAAY,cAACsE,EAAA,EAAD,IAAuB,kBAItChF,GAASxT,KACT,cAAC+Q,EAAD,CACE0H,QAASlB,GACT/E,QAAQ,YACRkG,SACExE,SAC4BnR,KAAlB,OAAV/C,SAAU,IAAVA,QAAA,EAAAA,GAAYqB,OAAOF,YAC0B4B,KAAnC,OAAV/C,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,OAAOF,YAAnB,iBAAyBjB,MAAMgY,WANnC,SASGhE,GAAY,cAACsE,EAAA,EAAD,IAAuB,gBAM3CxB,KAAUhJ,EAAMqF,QACf,uCACKrT,IACDwT,GAASxT,KACT8T,GAAoB,IACpB,cAACjD,EAAD,UACE,cAACE,EAAD,CACE2H,UACc,OAAZrR,SAAY,IAAZA,QAAA,EAAAA,GAAcnH,MAAMuH,YACpByM,MACA,OAAC7M,SAAD,IAACA,QAAD,EAACA,GAAcnH,MAAMwH,YACV,OAAV1H,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,cAAZ,sBAAoBF,YAApB,iBAA0BjB,MAAMyY,UACT,IAAtB7E,GAEJ2E,QAASpD,GACT7C,QAAQ,YATV,UAWa,OAAVxS,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,cAAZ,sBAAoBF,YAApB,iBAA0BjB,MAAMyY,UACX,IAAtB7E,GACE,UACc,OAAZzM,SAAY,IAAZA,QAAA,EAAAA,GAAcnH,MAAMuH,WACtB,WACEyM,GACF,cAACsE,EAAA,EAAD,IAEA,YAMNhF,GAASxT,KACT,cAAC+Q,EAAD,CACE0H,QAASlB,GACT/E,QAAQ,YACRkG,SACExE,SAC4BnR,KAAlB,OAAV/C,SAAU,IAAVA,QAAA,EAAAA,GAAYqB,OAAOF,YAC0B4B,KAAnC,OAAV/C,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,OAAOF,YAAnB,iBAAyBjB,MAAMgY,WANnC,SASGhE,GAAY,cAACsE,EAAA,EAAD,IAAuB,mBApG9C,eAAC9H,EAAD,qBACU,IACP,CAAC1C,EAAMiF,QAAQgF,SAASjB,IAAS,SAAW,mBA0GjD,eAAC7E,EAAA,EAAD,CACEC,WAAS,EACTpD,eAAe,gBACfE,MAAM,gBAHR,UAKE,cAAC0J,EAAA,EAAD,CACEC,UAAU,SACVrG,QAAQ,QACRtD,MAAM,gBACN4J,MAAM,OACNL,QAAS,WACPzD,IAAa,IANjB,oCAWW,OAAVhV,SAAU,IAAVA,QAAA,EAAAA,GAAYqB,OAAOF,OAClB,cAACyX,EAAA,EAAD,CACEC,UAAU,SACVrG,QAAQ,QACRtD,MAAM,gBACN4J,MAAM,QACNL,QAAS,YAEJzY,IACDgX,KAAUhJ,EAAMoF,SAChBI,GAASxT,KACT8T,GAAoB,EAEpBoB,IAAuB,GAEvBqC,MAdN,+BAsBJ,cAACwB,EAAA,EAAD,CACEtE,KAAMQ,GACN+D,QAAS,kBAAM9D,IAAuB,IACtC+D,WAAY,CACVjP,MAAO,CAAE8N,gBAAiB,UAAW3I,aAAc,IAJvD,SAOE,cAAC,IAAD,CAAkBnF,MAAO,CAAEuE,QAAS,IAApC,0KAMF,cAACwK,EAAA,EAAD,CACEtE,KAAMU,GACN6D,QAAS,WACP5D,IAAqB,IAEvB6D,WAAY,CACVjP,MAAO,CAAE8N,gBAAiB,UAAW3I,aAAc,IANvD,SASE,eAAC,IAAD,CAAkBnF,MAAO,CAAEuE,QAAS,IAApC,YACG,OAACvO,SAAD,IAACA,QAAD,EAACA,GAAYE,MAAMiB,KAAK+X,iBACvB,+EAES,OAAVlZ,SAAU,IAAVA,QAAA,EAAAA,GAAYE,MAAMiB,KAAK+X,iBACtBlZ,GAAWE,MAAMiB,KAAK+X,eAAeC,kBACnC,gCACE,iDACA,qIAIA,8CANF,2BAO2B,IACxBnZ,GAAWE,MAAMiB,KAAK+X,eAAeE,UAAY,IARpD,YAQ6D,KAC/C,OAAVpZ,SAAU,IAAVA,QAAA,EAAAA,GAAYY,UACZZ,GAAWE,MAAMiB,KAAK+X,eAAeE,WACjB,IAAnBlV,oBAXL,0DAY0D,IACvDlE,GAAWE,MAAMiB,KAAK+X,eAAeG,iBAAiBvX,WAAY,IAbrE,qBAcqB,IAClB9B,GAAWE,MAAMiB,KAAKmY,eAAexX,WAfxC,sBAiBE,6CACe,IACZ9B,GAAWE,MAAMiB,KAAK+X,eAAeG,iBAAiBvX,WAAY,IAFrE,oBAGoB,IAHpB,WAIG8H,YACC5J,GAAWE,MAAMiB,KAAK+X,eAAeC,yBALzC,cAIG,GAEEI,qBAAsB,IAN3B,KAOK,IAPL,WAQG3P,YACC5J,GAAWE,MAAMiB,KAAK+X,eAAeC,yBATzC,cAQG,GAEEK,qBAVL,gDAWgD,IAC7CxZ,GAAWE,MAAMiB,KAAK+X,eAAeE,UAAY,IAZpD,mCAeW,OAAVpZ,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,cAAZ,iBAAoBF,SACnB,OAACnB,SAAD,IAACA,IAAD,WAACA,GAAYqB,cAAb,cAAC,GAAoBF,KAAKjB,MAAMgY,YAC9B,cAACnH,EAAD,CACE0H,QAASnB,GACT9E,QAAQ,YACRkG,UACK1Y,GAAWqB,OAAOF,OACpBnB,GAAWqB,OAAOF,KAAKjB,MAAMyY,SAC9B/Q,KAAKkI,MAAQ,IACX9P,GAAWE,MAAMiB,KAAK+X,eAAeC,iBAAiBrX,WAP5D,SAUGoS,GACC,cAACsE,EAAA,EAAD,IACE5Q,KAAKkI,MAAQ,IACf9P,GAAWE,MAAMiB,KAAK+X,eAAeC,iBAAiBrX,WACtD,gDAEE,cAAC,IAAD,CACE0N,KAAM5F,YACJ5J,GAAWE,MAAMiB,KAAK+X,eACnBC,uBAKT,WAKR,qBAAKnP,MAAO,CAAEyP,UAAW,SAAU9H,UAAW,QAA9C,UACa,OAAV3R,SAAU,IAAVA,IAAA,WAAAA,GAAYqB,cAAZ,iBAAoBF,SACnB,OAACnB,SAAD,IAACA,IAAD,WAACA,GAAYqB,cAAb,mBAAC,GAAoBF,YAArB,cAAC,GAA0BjB,MAAMyY,UAC/B,kIAUhB,eAACI,EAAA,EAAD,CACEtE,KAAMM,GACNiE,QAAS,kBAAMhE,IAAa,IAC5BiE,WAAY,CACVjP,MAAO,CAAE8N,gBAAiB,UAAW3I,aAAc,IAJvD,UAOE,eAAC,IAAD,CACEuK,mBAAiB,EACjB1P,MAAO,CACLsE,QAAS,OACTS,WAAY,SACZC,eAAgB,iBALpB,UAQE,cAAC4J,EAAA,EAAD,CACEC,UAAU,SACVrG,QAAQ,KACRtD,MAAM,gBACNuJ,QAAS,WACPzD,IAAa,IALjB,0BAUA,cAAC2E,EAAA,EAAD,CACE,aAAW,QACXrJ,UAAWW,EAAaC,YACxBuH,QAAS,kBAAMzD,IAAa,IAH9B,SAKE,cAAC,IAAD,SAGJ,eAAC,IAAD,WACE,cAACzC,EAAA,EAAD,CAAYC,QAAQ,KAApB,2CAGA,eAACD,EAAA,EAAD,CAAYqH,cAAY,EAAC1K,MAAM,gBAA/B,4RAMG,KACU,OAAVlP,SAAU,IAAVA,IAAA,WAAAA,GAAYE,aAAZ,sBAAmBiB,YAAnB,iBAAyBwW,MACxB,+BACE,6DAC0B,KACb,OAAV3X,SAAU,IAAVA,IAAA,WAAAA,GAAYE,aAAZ,sBAAmBiB,YAAnB,iBAAyBwW,IAAI7V,YAC5BoC,mBAAkB,IAHtB,eASN,cAACqO,EAAA,EAAD,CAAYC,QAAQ,KAApB,qCACA,cAACD,EAAA,EAAD,CAAYqH,cAAY,EAAC1K,MAAM,gBAA/B,wVAQCsI,GACC,qCACE,cAACjF,EAAA,EAAD,CAAYC,QAAQ,KAApB,0CAGA,cAACD,EAAA,EAAD,CAAYqH,cAAY,EAAC1K,MAAM,gBAA/B,uMAQF,qCACE,cAACqD,EAAA,EAAD,CAAYC,QAAQ,KAApB,oCACA,cAACD,EAAA,EAAD,CAAYqH,cAAY,EAAC1K,MAAM,gBAA/B,gQAOA,cAACqD,EAAA,EAAD,CAAYC,QAAQ,KAApB,0CAGA,eAACD,EAAA,EAAD,CAAYqH,cAAY,EAAC1K,MAAM,gBAA/B,eACK,KACU,OAAZ7H,SAAY,IAAZA,QAAA,EAAAA,GAAcnH,MAAMyH,YAApB,WACGiC,YAAM,OACJvC,SADI,IACJA,QADI,EACJA,GAAcnH,MAAMyH,mBAFzB,cACG,GAEGkS,iBACH,mBANN,wJA6Bb7Z,IACC,cAAC4X,EAAA,EAAD,CACEC,SAAS,KACT7N,MAAO,CAAEmH,SAAU,WAAYQ,UAAW,IAF5C,SAIE,qBAAK3H,MAAO,CAAEyE,OAAQ,IAAtB,SACE,eAAC0D,EAAA,EAAD,CAAMC,WAAS,EAACE,UAAU,MAAMwH,KAAK,SAArC,UACE,eAAC3H,EAAA,EAAD,CAAMC,WAAS,EAAC2H,GAAI,EAAGzH,UAAU,SAAjC,UACE,cAACC,EAAA,EAAD,CAAYC,QAAQ,QAAQtD,MAAM,gBAAlC,kBAGA,cAACqD,EAAA,EAAD,CACEC,QAAQ,KACRtD,MAAM,cACNlF,MAAO,CAAEqF,WAAY,QAHvB,UAKa,OAAVrP,SAAU,IAAVA,QAAA,EAAAA,GAAYE,MAAM8Z,kBAAkBlY,aAAc,OAGvD,eAACqQ,EAAA,EAAD,CAAMC,WAAS,EAAC2H,GAAI,EAAGzH,UAAU,SAAjC,UACE,cAACC,EAAA,EAAD,CAAYC,QAAQ,QAAQtD,MAAM,gBAAlC,wBAGA,eAACqD,EAAA,EAAD,CACEC,QAAQ,KACRtD,MAAM,cACNlF,MAAO,CAAEqF,WAAY,QAHvB,mBAKI,IACD2H,KAAUhJ,EAAMgF,QAAUgE,KAAUhJ,EAAMiF,OACvC,MACA9I,IAAaC,OAAO2M,UAG5B,eAAC5E,EAAA,EAAD,CAAMC,WAAS,EAAC2H,GAAI,EAAGzH,UAAU,SAAjC,UACE,cAACC,EAAA,EAAD,CAAYC,QAAQ,QAAQtD,MAAM,gBAAlC,0BAGA,eAACqD,EAAA,EAAD,CACEC,QAAQ,KACRtD,MAAM,cACNlF,MAAO,CAAEqF,WAAY,QAHvB,mBAKI,IACDlF,IAAaC,SACD,OAAVpK,SAAU,IAAVA,QAAA,EAAAA,GAAYY,WAAY,GAAKsD,iCAQ5C,cAAC+V,EAAA,EAAD,CACExF,KAAME,GAAWF,KACjByF,iBAAkB,IAClBlB,QAAS,kBAAMpE,GAAc,2BAAKD,IAAN,IAAkBF,MAAM,MAHtD,SAKE,cAAC2D,EAAA,EAAD,CACEY,QAAS,kBAAMpE,GAAc,2BAAKD,IAAN,IAAkBF,MAAM,MACpDC,SAAUC,GAAWD,SAFvB,SAIGC,GAAWhH,gB,iDE3sChBwM,GAAkBC,IAAMC,cAA2C,MAE5DC,GAAmB,SAAC,GAAgC,IAAD,IAA7BC,gBAA6B,MAAlB,KAAkB,EACxDC,EAAYC,mBACZC,EAAcD,mBAEdE,EAAepG,mBACnB,kBAAM,WAC2C,IAAD,EAA1CmG,EAAYE,SAAWJ,EAAUI,UACnCJ,EAAUI,QAAQ5Q,MAAM6Q,WAAa,UACrC,UAAAH,EACGE,QAAQ,CACPE,cAAe,IACfC,OAAQ,IACRC,OAAQ,CAAEC,EAAG,aAJjB,SAMIC,SAAQ,WACJV,EAAUI,UACZJ,EAAUI,QAAQ5Q,MAAM6Q,WAAa,iBAK/C,IAGF5E,qBAAU,WACJuE,EAAUI,UAAYF,EAAYE,UACpCJ,EAAUI,QAAQ5Q,MAAM6Q,WAAa,SACrCH,EAAYE,QAAUO,KAASC,OAAOZ,EAAUI,QAAS,CACvDS,QAAQ,EACRC,WAAW,OAGd,IAWH,OACE,eAACnB,GAAgBoB,SAAjB,CAA0B9U,MAAO,CAAEkU,gBAAnC,UACE,wBAAQa,IAAKhB,EAAkBxQ,MAXM,CACvC2E,MAAO,QACPC,OAAQ,QACRuC,SAAU,WACVsK,OAAQ,EACRpK,IAAK,EACLqK,KAAM,KAMHnB,MChCDpM,GAAQwN,aAAY,CACxBrK,QAAS,CACPsK,KAAM,UAQJrc,GAAe,IAAIJ,KAAYC,UACnCyc,gDAMIrc,GAAa,IAAIL,KAAY2c,WADnBD,sFAGVE,GAAgBC,SAASH,gYAAYI,2BAA6B,IAiCzDC,GA7BH,WACV,IAAMC,EAAW5H,mBAAQ,kBAAM6H,wBAVjBP,kBAUyC,IAEjDQ,EAAU9H,mBACd,iBAAM,CAAC+H,8BAAoBC,+BAAqBC,gCAChD,IAGF,OACE,cAACC,GAAA,EAAD,CAAetO,MAAOA,GAAtB,SACE,cAAC,qBAAD,CAAoBgO,SAAUA,EAA9B,SACE,cAAC,iBAAD,CAAgBE,QAASA,EAASK,aAAW,EAA7C,SACE,cAAC,uBAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,CACEtV,eA9BZrE,UA+BYxD,aAAcA,GACdC,WAAYA,GACZmd,UAAWZ,GACXrG,UArBE,iBC9BHkH,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCHdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFC,SAASC,eAAe,SAM1Bb,O","file":"static/js/main.b7570362.chunk.js","sourcesContent":["import * as anchor from '@project-serum/anchor';\n\nimport { TOKEN_PROGRAM_ID, Token } from '@solana/spl-token';\nimport { LAMPORTS_PER_SOL, TransactionInstruction } from '@solana/web3.js';\nimport {\n  createAssociatedTokenAccountInstruction,\n  getAtaForMint,\n  getFairLaunchTicketSeqLookup,\n} from './utils';\n\nexport const FAIR_LAUNCH_PROGRAM = new anchor.web3.PublicKey(\n  'faircnAB9k59Y4TXmLabBULeuTLgV7TkGMGNkjnA15j',\n);\n\nexport interface FairLaunchAccount {\n  id: anchor.web3.PublicKey;\n  program: anchor.Program;\n  state: FairLaunchState;\n  ticket: {\n    pubkey: anchor.web3.PublicKey;\n    bump: number;\n    data?: FairLaunchTicket;\n  };\n  lottery: {\n    pubkey: anchor.web3.PublicKey;\n    data?: Uint8Array;\n  };\n  treasury: number;\n}\n\nexport interface FairLaunchTicket {\n  fairLaunch: anchor.web3.PublicKey;\n  buyer: anchor.web3.PublicKey;\n  amount: anchor.BN;\n  state: {\n    punched?: {};\n    unpunched?: {};\n    withdrawn?: {};\n    no_sequence_struct: {};\n  };\n  bump: number;\n  seq: anchor.BN;\n}\n\nexport interface AntiRugSetting {\n  reserveBp: number;\n  tokenRequirement: anchor.BN;\n  selfDestructDate: anchor.BN;\n}\nexport interface FairLaunchState {\n  authority: anchor.web3.PublicKey;\n  bump: number;\n  winner: anchor.web3.PublicKey;\n  currentMedian: anchor.BN;\n  currentEligibleHolders: anchor.BN;\n  data: {\n    currentWinner: anchor.web3.PublicKey;\n    antiRugSetting?: AntiRugSetting;\n    fee: anchor.BN;\n    numberOfTokens: anchor.BN;\n    phaseOneEnd: anchor.BN;\n    phaseOneStart: anchor.BN;\n    phaseTwoEnd: anchor.BN;\n    priceRangeEnd: anchor.BN;\n    priceRangeStart: anchor.BN;\n    lotteryDuration: anchor.BN;\n    tickSize: anchor.BN;\n    uuid: string;\n  };\n  numberTicketsDropped: anchor.BN;\n  numberTicketsPunched: anchor.BN;\n  numberTicketsSold: anchor.BN;\n  numberTicketsUnSeqed: anchor.BN;\n  numberTokensBurnedForRefunds: anchor.BN;\n  numberTokensPreminted: anchor.BN;\n  phaseThreeStarted: boolean;\n  tokenMint: anchor.web3.PublicKey;\n  tokenMintBump: number;\n  treasury: anchor.web3.PublicKey;\n  treasuryBump: number;\n  treasuryMint: anchor.web3.PublicKey; // only for SPL tokens\n  treasurySnapshot: null;\n}\n\nexport enum LotteryState {\n  Brewing = 'Brewing',\n  Finished = 'Finished',\n  PastDue = 'Past Due',\n}\n\nexport const getLotteryState = (\n  phaseThree: boolean | undefined,\n  lottery: Uint8Array | null,\n  lotteryDuration: anchor.BN,\n  phaseTwoEnd: anchor.BN,\n): LotteryState => {\n  if (\n    !phaseThree &&\n    (!lottery || lottery.length === 0) &&\n    phaseTwoEnd.add(lotteryDuration).lt(new anchor.BN(Date.now() / 1000))\n  ) {\n    return LotteryState.PastDue;\n  } else if (phaseThree) {\n    return LotteryState.Finished;\n  } else {\n    return LotteryState.Brewing;\n  }\n};\n\nexport const getFairLaunchState = async (\n  anchorWallet: anchor.Wallet,\n  fairLaunchId: anchor.web3.PublicKey,\n  connection: anchor.web3.Connection,\n): Promise<FairLaunchAccount> => {\n  const provider = new anchor.Provider(connection, anchorWallet, {\n    preflightCommitment: 'recent',\n  });\n\n  const idl = await anchor.Program.fetchIdl(FAIR_LAUNCH_PROGRAM, provider);\n\n  const program = new anchor.Program(idl, FAIR_LAUNCH_PROGRAM, provider);\n  const state: any = await program.account.fairLaunch.fetch(fairLaunchId);\n\n  const [fairLaunchTicket, bump] = await getFairLaunchTicket(\n    //@ts-ignore\n    state.tokenMint,\n    anchorWallet.publicKey,\n  );\n\n  let fairLaunchData: any;\n\n  try {\n    fairLaunchData = await program.account.fairLaunchTicket.fetch(\n      fairLaunchTicket,\n    );\n  } catch {\n    console.log('No ticket');\n  }\n\n  const treasury = await program.provider.connection.getBalance(state.treasury);\n\n  let lotteryData: Uint8Array = new Uint8Array([]);\n  let fairLaunchLotteryBitmap = (\n    await getFairLaunchLotteryBitmap(\n      //@ts-ignore\n      state.tokenMint,\n    )\n  )[0];\n\n  try {\n    const fairLaunchLotteryBitmapObj =\n      await program.provider.connection.getAccountInfo(fairLaunchLotteryBitmap);\n\n    lotteryData = new Uint8Array(fairLaunchLotteryBitmapObj?.data || []);\n  } catch (e) {\n    console.log('Could not find fair launch lottery.');\n    console.log(e);\n  }\n\n  return {\n    id: fairLaunchId,\n    state,\n    program,\n    ticket: {\n      pubkey: fairLaunchTicket,\n      bump,\n      data: fairLaunchData,\n    },\n    lottery: {\n      pubkey: fairLaunchLotteryBitmap,\n      data: lotteryData,\n    },\n    treasury,\n  };\n};\n\nexport const punchTicket = async (\n  anchorWallet: anchor.Wallet,\n  fairLaunch: FairLaunchAccount,\n) => {\n  const fairLaunchTicket = (\n    await getFairLaunchTicket(\n      //@ts-ignore\n      fairLaunch.state.tokenMint,\n      anchorWallet.publicKey,\n    )\n  )[0];\n\n  const ticket = fairLaunch.ticket.data;\n\n  const fairLaunchLotteryBitmap = ( //@ts-ignore\n    await getFairLaunchLotteryBitmap(fairLaunch.state.tokenMint)\n  )[0];\n\n  const buyerTokenAccount = (\n    await getAtaForMint(\n      //@ts-ignore\n      fairLaunch.state.tokenMint,\n      anchorWallet.publicKey,\n    )\n  )[0];\n\n  if (ticket?.amount.gt(fairLaunch.state.currentMedian)) {\n    console.log(\n      'Adjusting down...',\n      ticket?.amount.toNumber(),\n      fairLaunch.state.currentMedian.toNumber(),\n    );\n    const { remainingAccounts, instructions, signers } =\n      await getSetupForTicketing(\n        fairLaunch.program,\n        fairLaunch.state.currentMedian.toNumber(),\n        anchorWallet,\n        fairLaunch,\n        fairLaunchTicket,\n      );\n    await fairLaunch.program.rpc.adjustTicket(fairLaunch.state.currentMedian, {\n      accounts: {\n        fairLaunchTicket,\n        fairLaunch: fairLaunch.id,\n        fairLaunchLotteryBitmap,\n        //@ts-ignore\n        treasury: fairLaunch.state.treasury,\n        systemProgram: anchor.web3.SystemProgram.programId,\n        clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\n        currentWinner: fairLaunch.state.data.currentWinner,\n      },\n      __private: { logAccounts: true },\n      instructions: instructions.length > 0 ? instructions : undefined,\n      remainingAccounts: [\n        {\n          pubkey: anchorWallet.publicKey,\n          isSigner: true,\n          isWritable: true,\n        },\n        ...remainingAccounts,\n      ],\n      signers,\n    });\n  }\n\n  const accountExists =\n    await fairLaunch.program.provider.connection.getAccountInfo(\n      buyerTokenAccount,\n    );\n\n  const instructions = !accountExists\n    ? [\n        createAssociatedTokenAccountInstruction(\n          buyerTokenAccount,\n          anchorWallet.publicKey,\n          anchorWallet.publicKey,\n          //@ts-ignore\n          fairLaunch.state.tokenMint,\n        ),\n      ]\n    : [];\n\n  await fairLaunch.program.rpc.punchTicket({\n    accounts: {\n      fairLaunchTicket,\n      fairLaunch: fairLaunch.id,\n      fairLaunchLotteryBitmap,\n      payer: anchorWallet.publicKey,\n      buyerTokenAccount,\n      //@ts-ignore\n      tokenMint: fairLaunch.state.tokenMint,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n    instructions: instructions.length > 0 ? instructions : undefined,\n  });\n};\n\nexport const getFairLaunchTicket = async (\n  tokenMint: anchor.web3.PublicKey,\n  buyer: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [Buffer.from('fair_launch'), tokenMint.toBuffer(), buyer.toBuffer()],\n    FAIR_LAUNCH_PROGRAM,\n  );\n};\n\nexport const getFairLaunchLotteryBitmap = async (\n  tokenMint: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [Buffer.from('fair_launch'), tokenMint.toBuffer(), Buffer.from('lottery')],\n    FAIR_LAUNCH_PROGRAM,\n  );\n};\n\nconst getSetupForTicketing = async (\n  anchorProgram: anchor.Program,\n  amount: number,\n  anchorWallet: anchor.Wallet,\n  fairLaunch: FairLaunchAccount | undefined,\n  ticketKey: anchor.web3.PublicKey,\n): Promise<{\n  remainingAccounts: {\n    pubkey: anchor.web3.PublicKey | null;\n    isWritable: boolean;\n    isSigner: boolean;\n  }[];\n  instructions: TransactionInstruction[];\n  signers: anchor.web3.Keypair[];\n  amountLamports: number;\n}> => {\n  if (!fairLaunch) {\n    return {\n      remainingAccounts: [],\n      instructions: [],\n      signers: [],\n      amountLamports: 0,\n    };\n  }\n  const ticket = fairLaunch.ticket;\n\n  const remainingAccounts = [];\n  const instructions = [];\n  const signers = [];\n\n  let amountLamports = 0;\n  //@ts-ignore\n  if (!fairLaunch.state.treasuryMint) {\n    if (!ticket && amount === 0) {\n      amountLamports = fairLaunch.state.data.priceRangeStart.toNumber();\n    } else {\n      amountLamports = Math.ceil(amount * LAMPORTS_PER_SOL);\n    }\n  } else {\n    const transferAuthority = anchor.web3.Keypair.generate();\n    signers.push(transferAuthority);\n    // NOTE this token impl will not work till you get decimal mantissa and multiply...\n    /// ex from cli wont work since you dont have a Signer, but an anchor.Wallet\n    /*\n    const token = new Token(\n        anchorProgram.provider.connection,\n        //@ts-ignore\n        fairLaunchObj.treasuryMint,\n        TOKEN_PROGRAM_ID,\n        walletKeyPair,\n      );\n      const mintInfo = await token.getMintInfo();\n      amountNumber = Math.ceil(amountNumber * 10 ** mintInfo.decimals);\n    */\n    instructions.push(\n      Token.createApproveInstruction(\n        TOKEN_PROGRAM_ID,\n        //@ts-ignore\n        fairLaunch.state.treasuryMint,\n        transferAuthority.publicKey,\n        anchorWallet.publicKey,\n        [],\n        //@ts-ignore\n\n        // TODO: get mint decimals\n        amountNumber + fairLaunch.state.data.fees.toNumber(),\n      ),\n    );\n\n    remainingAccounts.push({\n      //@ts-ignore\n      pubkey: fairLaunch.state.treasuryMint,\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: (\n        await getAtaForMint(\n          //@ts-ignore\n          fairLaunch.state.treasuryMint,\n          anchorWallet.publicKey,\n        )\n      )[0],\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: transferAuthority.publicKey,\n      isWritable: false,\n      isSigner: true,\n    });\n    remainingAccounts.push({\n      pubkey: TOKEN_PROGRAM_ID,\n      isWritable: false,\n      isSigner: false,\n    });\n  }\n\n  if (ticket.data) {\n    const [fairLaunchTicketSeqLookup, seqBump] =\n      await getFairLaunchTicketSeqLookup(\n        fairLaunch.state.tokenMint,\n        ticket.data?.seq,\n      );\n\n    const seq = await anchorProgram.provider.connection.getAccountInfo(\n      fairLaunchTicketSeqLookup,\n    );\n    if (!seq) {\n      instructions.push(\n        await anchorProgram.instruction.createTicketSeq(seqBump, {\n          accounts: {\n            fairLaunchTicketSeqLookup,\n            fairLaunch: fairLaunch.id,\n            fairLaunchTicket: ticketKey,\n            payer: anchorWallet.publicKey,\n            systemProgram: anchor.web3.SystemProgram.programId,\n            rent: anchor.web3.SYSVAR_RENT_PUBKEY,\n          },\n          signers: [],\n        }),\n      );\n    }\n  }\n\n  return {\n    remainingAccounts,\n    instructions,\n    signers,\n    amountLamports,\n  };\n};\n\nexport const receiveRefund = async (\n  anchorWallet: anchor.Wallet,\n  fairLaunch: FairLaunchAccount | undefined,\n) => {\n  if (!fairLaunch) {\n    return;\n  }\n\n  const buyerTokenAccount = (\n    await getAtaForMint(fairLaunch.state.tokenMint, anchorWallet.publicKey)\n  )[0];\n\n  const transferAuthority = anchor.web3.Keypair.generate();\n\n  const signers = [transferAuthority];\n  const instructions = [\n    Token.createApproveInstruction(\n      TOKEN_PROGRAM_ID,\n      buyerTokenAccount,\n      transferAuthority.publicKey,\n      anchorWallet.publicKey,\n      [],\n      1,\n    ),\n  ];\n\n  const remainingAccounts = [];\n\n  if (fairLaunch.state.treasuryMint) {\n    remainingAccounts.push({\n      pubkey: fairLaunch.state.treasuryMint,\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: (\n        await getAtaForMint(\n          fairLaunch.state.treasuryMint,\n          anchorWallet.publicKey,\n        )\n      )[0],\n      isWritable: true,\n      isSigner: false,\n    });\n  }\n\n  console.log(\n    'tfr',\n    fairLaunch.state.treasury.toBase58(),\n    anchorWallet.publicKey.toBase58(),\n    buyerTokenAccount.toBase58(),\n  );\n  await fairLaunch.program.rpc.receiveRefund({\n    accounts: {\n      fairLaunch: fairLaunch.id,\n      treasury: fairLaunch.state.treasury,\n      buyer: anchorWallet.publicKey,\n      buyerTokenAccount,\n      transferAuthority: transferAuthority.publicKey,\n      tokenMint: fairLaunch.state.tokenMint,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      systemProgram: anchor.web3.SystemProgram.programId,\n      clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\n    },\n\n    __private: { logAccounts: true },\n    remainingAccounts,\n    instructions,\n    signers,\n  });\n};\nexport const purchaseTicket = async (\n  amount: number,\n  anchorWallet: anchor.Wallet,\n  fairLaunch: FairLaunchAccount | undefined,\n) => {\n  if (!fairLaunch) {\n    return;\n  }\n\n  const ticket = fairLaunch.ticket.data;\n\n  const [fairLaunchTicket, bump] = await getFairLaunchTicket(\n    //@ts-ignore\n    fairLaunch.state.tokenMint,\n    anchorWallet.publicKey,\n  );\n\n  const { remainingAccounts, instructions, signers, amountLamports } =\n    await getSetupForTicketing(\n      fairLaunch.program,\n      amount,\n      anchorWallet,\n      fairLaunch,\n      fairLaunchTicket,\n    );\n\n  if (ticket) {\n    const fairLaunchLotteryBitmap = //@ts-ignore\n    (await getFairLaunchLotteryBitmap(fairLaunch.state.tokenMint))[0];\n    console.log(\n      'Anchor wallet',\n      anchorWallet.publicKey.toBase58(),\n      amountLamports,\n    );\n    await fairLaunch.program.rpc.adjustTicket(new anchor.BN(amountLamports), {\n      accounts: {\n        fairLaunchTicket,\n        fairLaunch: fairLaunch.id,\n        fairLaunchLotteryBitmap,\n        //@ts-ignore\n        treasury: fairLaunch.state.treasury,\n        systemProgram: anchor.web3.SystemProgram.programId,\n        clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\n        currentWinner: fairLaunch.state.data.currentWinner,\n      },\n      __private: { logAccounts: true },\n      remainingAccounts: [\n        {\n          pubkey: anchorWallet.publicKey,\n          isSigner: true,\n          isWritable: true,\n        },\n        ...remainingAccounts,\n      ],\n      signers,\n      instructions: instructions.length > 0 ? instructions : undefined,\n    });\n\n    return;\n  }\n  try {\n    console.log('Amount', amountLamports);\n    console.log(fairLaunch.state);\n    await fairLaunch.program.rpc.purchaseTicket(\n      bump,\n      new anchor.BN(amountLamports),\n      {\n        accounts: {\n          fairLaunchTicket,\n          fairLaunch: fairLaunch.id,\n          //@ts-ignore\n          treasury: fairLaunch.state.treasury,\n          buyer: anchorWallet.publicKey,\n          payer: anchorWallet.publicKey,\n          systemProgram: anchor.web3.SystemProgram.programId,\n          rent: anchor.web3.SYSVAR_RENT_PUBKEY,\n          clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\n          currentWinner: fairLaunch.state.data.currentWinner,\n        },\n        //__private: { logAccounts: true },\n        remainingAccounts,\n        signers,\n        instructions: instructions.length > 0 ? instructions : undefined,\n      },\n    );\n  } catch (e) {\n    console.log(e);\n    throw e;\n  }\n};\n\nexport const withdrawFunds = async (\n  anchorWallet: anchor.Wallet,\n  fairLaunch: FairLaunchAccount | undefined,\n) => {\n  if (!fairLaunch) {\n    return;\n  }\n\n  // TODO: create sequence ticket\n\n  const remainingAccounts = [];\n\n  //@ts-ignore\n  if (fairLaunch.state.treasuryMint) {\n    remainingAccounts.push({\n      //@ts-ignore\n      pubkey: fairLaunch.state.treasuryMint,\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: (\n        await getAtaForMint(\n          //@ts-ignore\n          fairLaunch.state.treasuryMint,\n          anchorWallet.publicKey,\n        )\n      )[0],\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: TOKEN_PROGRAM_ID,\n      isWritable: false,\n      isSigner: false,\n    });\n  }\n\n  await fairLaunch.program.rpc.withdrawFunds({\n    accounts: {\n      fairLaunch: fairLaunch.id,\n      // @ts-ignore\n      treasury: fairLaunch.state.treasury,\n      authority: anchorWallet.publicKey,\n      // @ts-ignore\n      tokenMint: fairLaunch.state.tokenMint,\n      systemProgram: anchor.web3.SystemProgram.programId,\n    },\n    remainingAccounts,\n  });\n};\n","import * as anchor from '@project-serum/anchor';\r\n\r\nimport { MintLayout, TOKEN_PROGRAM_ID, Token } from '@solana/spl-token';\r\nimport { SystemProgram } from '@solana/web3.js';\r\nimport { sendTransactionWithRetry } from './connection';\r\n\r\nimport {\r\n  getAtaForMint,\r\n  SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\r\n} from './utils';\r\n\r\nexport const CANDY_MACHINE_PROGRAM = new anchor.web3.PublicKey(\r\n  'cndyAnrLdpjq1Ssp1z8xxDsB8dxe7u4HL5Nxi2K5WXZ',\r\n);\r\n\r\nconst TOKEN_METADATA_PROGRAM_ID = new anchor.web3.PublicKey(\r\n  'metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s',\r\n);\r\n\r\ninterface CandyMachineState {\r\n  itemsAvailable: number;\r\n  itemsRedeemed: number;\r\n  itemsRemaining: number;\r\n  config: anchor.web3.PublicKey;\r\n  treasury: anchor.web3.PublicKey;\r\n  tokenMint: anchor.web3.PublicKey;\r\n  isSoldOut: boolean;\r\n  isActive: boolean;\r\n  goLiveDate: anchor.BN;\r\n  price: anchor.BN;\r\n}\r\n\r\nexport interface CandyMachineAccount {\r\n  id: anchor.web3.PublicKey;\r\n  program: anchor.Program;\r\n  state: CandyMachineState;\r\n}\r\n\r\nexport const awaitTransactionSignatureConfirmation = async (\r\n  txid: anchor.web3.TransactionSignature,\r\n  timeout: number,\r\n  connection: anchor.web3.Connection,\r\n  commitment: anchor.web3.Commitment = 'recent',\r\n  queryStatus = false,\r\n): Promise<anchor.web3.SignatureStatus | null | void> => {\r\n  let done = false;\r\n  let status: anchor.web3.SignatureStatus | null | void = {\r\n    slot: 0,\r\n    confirmations: 0,\r\n    err: null,\r\n  };\r\n  let subId = 0;\r\n  status = await new Promise(async (resolve, reject) => {\r\n    setTimeout(() => {\r\n      if (done) {\r\n        return;\r\n      }\r\n      done = true;\r\n      console.log('Rejecting for timeout...');\r\n      reject({ timeout: true });\r\n    }, timeout);\r\n    while (!done && queryStatus) {\r\n      // eslint-disable-next-line no-loop-func\r\n      (async () => {\r\n        try {\r\n          const signatureStatuses = await connection.getSignatureStatuses([\r\n            txid,\r\n          ]);\r\n          status = signatureStatuses && signatureStatuses.value[0];\r\n          if (!done) {\r\n            if (!status) {\r\n              console.log('REST null result for', txid, status);\r\n            } else if (status.err) {\r\n              console.log('REST error for', txid, status);\r\n              done = true;\r\n              reject(status.err);\r\n            } else if (!status.confirmations) {\r\n              console.log('REST no confirmations for', txid, status);\r\n            } else {\r\n              console.log('REST confirmation for', txid, status);\r\n              done = true;\r\n              resolve(status);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          if (!done) {\r\n            console.log('REST connection error: txid', txid, e);\r\n          }\r\n        }\r\n      })();\r\n      await sleep(2000);\r\n    }\r\n  });\r\n\r\n  //@ts-ignore\r\n  if (connection._signatureSubscriptions[subId]) {\r\n    connection.removeSignatureListener(subId);\r\n  }\r\n  done = true;\r\n  console.log('Returning status', status);\r\n  return status;\r\n};\r\n\r\n/* export */ const createAssociatedTokenAccountInstruction = (\r\n  associatedTokenAddress: anchor.web3.PublicKey,\r\n  payer: anchor.web3.PublicKey,\r\n  walletAddress: anchor.web3.PublicKey,\r\n  splTokenMintAddress: anchor.web3.PublicKey,\r\n) => {\r\n  const keys = [\r\n    { pubkey: payer, isSigner: true, isWritable: true },\r\n    { pubkey: associatedTokenAddress, isSigner: false, isWritable: true },\r\n    { pubkey: walletAddress, isSigner: false, isWritable: false },\r\n    { pubkey: splTokenMintAddress, isSigner: false, isWritable: false },\r\n    {\r\n      pubkey: anchor.web3.SystemProgram.programId,\r\n      isSigner: false,\r\n      isWritable: false,\r\n    },\r\n    { pubkey: TOKEN_PROGRAM_ID, isSigner: false, isWritable: false },\r\n    {\r\n      pubkey: anchor.web3.SYSVAR_RENT_PUBKEY,\r\n      isSigner: false,\r\n      isWritable: false,\r\n    },\r\n  ];\r\n  return new anchor.web3.TransactionInstruction({\r\n    keys,\r\n    programId: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\r\n    data: Buffer.from([]),\r\n  });\r\n};\r\n\r\nexport const getCandyMachineState = async (\r\n  anchorWallet: anchor.Wallet,\r\n  candyMachineId: anchor.web3.PublicKey,\r\n  connection: anchor.web3.Connection,\r\n): Promise<CandyMachineAccount> => {\r\n  const provider = new anchor.Provider(connection, anchorWallet, {\r\n    preflightCommitment: 'recent',\r\n  });\r\n\r\n  const idl = await anchor.Program.fetchIdl(CANDY_MACHINE_PROGRAM, provider);\r\n\r\n  const program = new anchor.Program(idl, CANDY_MACHINE_PROGRAM, provider);\r\n\r\n  const state: any = await program.account.candyMachine.fetch(candyMachineId);\r\n  const itemsAvailable = state.data.itemsAvailable.toNumber();\r\n  const itemsRedeemed = state.itemsRedeemed.toNumber();\r\n  const itemsRemaining = itemsAvailable - itemsRedeemed;\r\n\r\n  return {\r\n    id: candyMachineId,\r\n    program,\r\n    state: {\r\n      itemsAvailable,\r\n      itemsRedeemed,\r\n      itemsRemaining,\r\n      isSoldOut: itemsRemaining === 0,\r\n      isActive: state.data.goLiveDate.toNumber() < new Date().getTime() / 1000,\r\n      goLiveDate: state.data.goLiveDate,\r\n      treasury: state.wallet,\r\n      tokenMint: state.tokenMint,\r\n      config: state.config,\r\n      price: state.data.price,\r\n    },\r\n  };\r\n};\r\n\r\nconst getMasterEdition = async (\r\n  mint: anchor.web3.PublicKey,\r\n): Promise<anchor.web3.PublicKey> => {\r\n  return (\r\n    await anchor.web3.PublicKey.findProgramAddress(\r\n      [\r\n        Buffer.from('metadata'),\r\n        TOKEN_METADATA_PROGRAM_ID.toBuffer(),\r\n        mint.toBuffer(),\r\n        Buffer.from('edition'),\r\n      ],\r\n      TOKEN_METADATA_PROGRAM_ID,\r\n    )\r\n  )[0];\r\n};\r\n\r\nconst getMetadata = async (\r\n  mint: anchor.web3.PublicKey,\r\n): Promise<anchor.web3.PublicKey> => {\r\n  return (\r\n    await anchor.web3.PublicKey.findProgramAddress(\r\n      [\r\n        Buffer.from('metadata'),\r\n        TOKEN_METADATA_PROGRAM_ID.toBuffer(),\r\n        mint.toBuffer(),\r\n      ],\r\n      TOKEN_METADATA_PROGRAM_ID,\r\n    )\r\n  )[0];\r\n};\r\n\r\nexport const mintOneToken = async (\r\n  candyMachine: CandyMachineAccount,\r\n  payer: anchor.web3.PublicKey,\r\n): Promise<string> => {\r\n  const mint = anchor.web3.Keypair.generate();\r\n\r\n  const userTokenAccountAddress = (\r\n    await getAtaForMint(mint.publicKey, payer)\r\n  )[0];\r\n\r\n  const userPayingAccountAddress = (\r\n    await getAtaForMint(candyMachine.state.tokenMint, payer)\r\n  )[0];\r\n\r\n  const candyMachineAddress = candyMachine.id;\r\n\r\n  const remainingAccounts = [];\r\n  const signers: anchor.web3.Keypair[] = [mint];\r\n  const instructions = [\r\n    anchor.web3.SystemProgram.createAccount({\r\n      fromPubkey: payer,\r\n      newAccountPubkey: mint.publicKey,\r\n      space: MintLayout.span,\r\n      lamports:\r\n        await candyMachine.program.provider.connection.getMinimumBalanceForRentExemption(\r\n          MintLayout.span,\r\n        ),\r\n      programId: TOKEN_PROGRAM_ID,\r\n    }),\r\n    Token.createInitMintInstruction(\r\n      TOKEN_PROGRAM_ID,\r\n      mint.publicKey,\r\n      0,\r\n      payer,\r\n      payer,\r\n    ),\r\n    createAssociatedTokenAccountInstruction(\r\n      userTokenAccountAddress,\r\n      payer,\r\n      payer,\r\n      mint.publicKey,\r\n    ),\r\n    Token.createMintToInstruction(\r\n      TOKEN_PROGRAM_ID,\r\n      mint.publicKey,\r\n      userTokenAccountAddress,\r\n      payer,\r\n      [],\r\n      1,\r\n    ),\r\n  ];\r\n\r\n  let tokenAccount;\r\n  if (candyMachine.state.tokenMint) {\r\n    const transferAuthority = anchor.web3.Keypair.generate();\r\n\r\n    signers.push(transferAuthority);\r\n    remainingAccounts.push({\r\n      pubkey: userPayingAccountAddress,\r\n      isWritable: true,\r\n      isSigner: false,\r\n    });\r\n    remainingAccounts.push({\r\n      pubkey: transferAuthority.publicKey,\r\n      isWritable: false,\r\n      isSigner: true,\r\n    });\r\n\r\n    instructions.push(\r\n      Token.createApproveInstruction(\r\n        TOKEN_PROGRAM_ID,\r\n        userPayingAccountAddress,\r\n        transferAuthority.publicKey,\r\n        payer,\r\n        [],\r\n        candyMachine.state.price.toNumber(),\r\n      ),\r\n    );\r\n  }\r\n  const metadataAddress = await getMetadata(mint.publicKey);\r\n  const masterEdition = await getMasterEdition(mint.publicKey);\r\n\r\n  instructions.push(\r\n    await candyMachine.program.instruction.mintNft({\r\n      accounts: {\r\n        config: candyMachine.state.config,\r\n        candyMachine: candyMachineAddress,\r\n        payer,\r\n        wallet: candyMachine.state.treasury,\r\n        mint: mint.publicKey,\r\n        metadata: metadataAddress,\r\n        masterEdition,\r\n        mintAuthority: payer,\r\n        updateAuthority: payer,\r\n        tokenMetadataProgram: TOKEN_METADATA_PROGRAM_ID,\r\n        tokenProgram: TOKEN_PROGRAM_ID,\r\n        systemProgram: SystemProgram.programId,\r\n        rent: anchor.web3.SYSVAR_RENT_PUBKEY,\r\n        clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\r\n      },\r\n      remainingAccounts:\r\n        remainingAccounts.length > 0 ? remainingAccounts : undefined,\r\n    }),\r\n  );\r\n\r\n  if (tokenAccount) {\r\n    instructions.push(\r\n      Token.createRevokeInstruction(\r\n        TOKEN_PROGRAM_ID,\r\n        userPayingAccountAddress,\r\n        payer,\r\n        [],\r\n      ),\r\n    );\r\n  }\r\n  try {\r\n    return (\r\n      await sendTransactionWithRetry(\r\n        candyMachine.program.provider.connection,\r\n        candyMachine.program.provider.wallet,\r\n        instructions,\r\n        signers,\r\n      )\r\n    ).txid;\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n  return 'j';\r\n};\r\n\r\nexport const shortenAddress = (address: string, chars = 4): string => {\r\n  return `${address.slice(0, chars)}...${address.slice(-chars)}`;\r\n};\r\n\r\nconst sleep = (ms: number): Promise<void> => {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n};\r\n","import * as anchor from '@project-serum/anchor';\nimport { TOKEN_PROGRAM_ID } from '@solana/spl-token';\nimport { SystemProgram } from '@solana/web3.js';\nimport {\n  LAMPORTS_PER_SOL,\n  SYSVAR_RENT_PUBKEY,\n  TransactionInstruction,\n} from '@solana/web3.js';\n\nexport const FAIR_LAUNCH_PROGRAM_ID = new anchor.web3.PublicKey(\n  'faircnAB9k59Y4TXmLabBULeuTLgV7TkGMGNkjnA15j',\n);\n\nexport const toDate = (value?: anchor.BN) => {\n  if (!value) {\n    return;\n  }\n\n  return new Date(value.toNumber() * 1000);\n};\n\nconst numberFormater = new Intl.NumberFormat('en-US', {\n  style: 'decimal',\n  minimumFractionDigits: 2,\n  maximumFractionDigits: 2,\n});\n\nexport const formatNumber = {\n  format: (val?: number) => {\n    if (!val) {\n      return '--';\n    }\n\n    return numberFormater.format(val);\n  },\n  asNumber: (val?: anchor.BN) => {\n    if (!val) {\n      return undefined;\n    }\n\n    return val.toNumber() / LAMPORTS_PER_SOL;\n  },\n};\n\nexport const SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID =\n  new anchor.web3.PublicKey('ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL');\n\nexport const getFairLaunchTicketSeqLookup = async (\n  tokenMint: anchor.web3.PublicKey,\n  seq: anchor.BN,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [\n      Buffer.from('fair_launch'),\n      tokenMint.toBuffer(),\n      seq.toArrayLike(Buffer, 'le', 8),\n    ],\n    FAIR_LAUNCH_PROGRAM_ID,\n  );\n};\n\nexport const getAtaForMint = async (\n  mint: anchor.web3.PublicKey,\n  buyer: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [buyer.toBuffer(), TOKEN_PROGRAM_ID.toBuffer(), mint.toBuffer()],\n    SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n  );\n};\n\nexport const getFairLaunchTicket = async (\n  tokenMint: anchor.web3.PublicKey,\n  buyer: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [Buffer.from('fair_launch'), tokenMint.toBuffer(), buyer.toBuffer()],\n    FAIR_LAUNCH_PROGRAM_ID,\n  );\n};\n\nexport function createAssociatedTokenAccountInstruction(\n  associatedTokenAddress: anchor.web3.PublicKey,\n  payer: anchor.web3.PublicKey,\n  walletAddress: anchor.web3.PublicKey,\n  splTokenMintAddress: anchor.web3.PublicKey,\n) {\n  const keys = [\n    {\n      pubkey: payer,\n      isSigner: true,\n      isWritable: true,\n    },\n    {\n      pubkey: associatedTokenAddress,\n      isSigner: false,\n      isWritable: true,\n    },\n    {\n      pubkey: walletAddress,\n      isSigner: false,\n      isWritable: false,\n    },\n    {\n      pubkey: splTokenMintAddress,\n      isSigner: false,\n      isWritable: false,\n    },\n    {\n      pubkey: SystemProgram.programId,\n      isSigner: false,\n      isWritable: false,\n    },\n    {\n      pubkey: TOKEN_PROGRAM_ID,\n      isSigner: false,\n      isWritable: false,\n    },\n    {\n      pubkey: SYSVAR_RENT_PUBKEY,\n      isSigner: false,\n      isWritable: false,\n    },\n  ];\n  return new TransactionInstruction({\n    keys,\n    programId: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n    data: Buffer.from([]),\n  });\n}\n","import {\r\n  Keypair,\r\n  Commitment,\r\n  Connection,\r\n  RpcResponseAndContext,\r\n  SignatureStatus,\r\n  SimulatedTransactionResponse,\r\n  Transaction,\r\n  TransactionInstruction,\r\n  TransactionSignature,\r\n  Blockhash,\r\n  FeeCalculator,\r\n} from '@solana/web3.js';\r\n\r\nimport {\r\n  WalletNotConnectedError,\r\n} from '@solana/wallet-adapter-base';\r\n\r\ninterface BlockhashAndFeeCalculator {\r\n  blockhash: Blockhash;\r\n  feeCalculator: FeeCalculator;\r\n}\r\n\r\nexport const getErrorForTransaction = async (\r\n  connection: Connection,\r\n  txid: string,\r\n) => {\r\n  // wait for all confirmation before geting transaction\r\n  await connection.confirmTransaction(txid, 'max');\r\n\r\n  const tx = await connection.getParsedConfirmedTransaction(txid);\r\n\r\n  const errors: string[] = [];\r\n  if (tx?.meta && tx.meta.logMessages) {\r\n    tx.meta.logMessages.forEach(log => {\r\n      const regex = /Error: (.*)/gm;\r\n      let m;\r\n      while ((m = regex.exec(log)) !== null) {\r\n        // This is necessary to avoid infinite loops with zero-width matches\r\n        if (m.index === regex.lastIndex) {\r\n          regex.lastIndex++;\r\n        }\r\n\r\n        if (m.length > 1) {\r\n          errors.push(m[1]);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport enum SequenceType {\r\n  Sequential,\r\n  Parallel,\r\n  StopOnFailure,\r\n}\r\n\r\nexport async function sendTransactionsWithManualRetry(\r\n  connection: Connection,\r\n  wallet: any,\r\n  instructions: TransactionInstruction[][],\r\n  signers: Keypair[][],\r\n) {\r\n  let stopPoint = 0;\r\n  let tries = 0;\r\n  let lastInstructionsLength = null;\r\n  let toRemoveSigners: Record<number, boolean> = {};\r\n  instructions = instructions.filter((instr, i) => {\r\n    if (instr.length > 0) {\r\n      return true;\r\n    } else {\r\n      toRemoveSigners[i] = true;\r\n      return false;\r\n    }\r\n  });\r\n  let filteredSigners = signers.filter((_, i) => !toRemoveSigners[i]);\r\n\r\n  while (stopPoint < instructions.length && tries < 3) {\r\n    instructions = instructions.slice(stopPoint, instructions.length);\r\n    filteredSigners = filteredSigners.slice(stopPoint, filteredSigners.length);\r\n\r\n    if (instructions.length === lastInstructionsLength) tries = tries + 1;\r\n    else tries = 0;\r\n\r\n    try {\r\n      if (instructions.length === 1) {\r\n        await sendTransactionWithRetry(\r\n          connection,\r\n          wallet,\r\n          instructions[0],\r\n          filteredSigners[0],\r\n          'single',\r\n        );\r\n        stopPoint = 1;\r\n      } else {\r\n        stopPoint = await sendTransactions(\r\n          connection,\r\n          wallet,\r\n          instructions,\r\n          filteredSigners,\r\n          SequenceType.StopOnFailure,\r\n          'single',\r\n        );\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    console.log(\r\n      'Died on ',\r\n      stopPoint,\r\n      'retrying from instruction',\r\n      instructions[stopPoint],\r\n      'instructions length is',\r\n      instructions.length,\r\n    );\r\n    lastInstructionsLength = instructions.length;\r\n  }\r\n}\r\n\r\nexport const sendTransactions = async (\r\n  connection: Connection,\r\n  wallet: any,\r\n  instructionSet: TransactionInstruction[][],\r\n  signersSet: Keypair[][],\r\n  sequenceType: SequenceType = SequenceType.Parallel,\r\n  commitment: Commitment = 'singleGossip',\r\n  successCallback: (txid: string, ind: number) => void = (txid, ind) => {},\r\n  failCallback: (reason: string, ind: number) => boolean = (txid, ind) => false,\r\n  block?: BlockhashAndFeeCalculator,\r\n): Promise<number> => {\r\n  if (!wallet.publicKey) throw new WalletNotConnectedError();\r\n\r\n  const unsignedTxns: Transaction[] = [];\r\n\r\n  if (!block) {\r\n    block = await connection.getRecentBlockhash(commitment);\r\n  }\r\n\r\n  for (let i = 0; i < instructionSet.length; i++) {\r\n    const instructions = instructionSet[i];\r\n    const signers = signersSet[i];\r\n\r\n    if (instructions.length === 0) {\r\n      continue;\r\n    }\r\n\r\n    let transaction = new Transaction();\r\n    instructions.forEach(instruction => transaction.add(instruction));\r\n    transaction.recentBlockhash = block.blockhash;\r\n    transaction.setSigners(\r\n      // fee payed by the wallet owner\r\n      wallet.publicKey,\r\n      ...signers.map(s => s.publicKey),\r\n    );\r\n\r\n    if (signers.length > 0) {\r\n      transaction.partialSign(...signers);\r\n    }\r\n\r\n    unsignedTxns.push(transaction);\r\n  }\r\n\r\n  const signedTxns = await wallet.signAllTransactions(unsignedTxns);\r\n\r\n  const pendingTxns: Promise<{ txid: string; slot: number }>[] = [];\r\n\r\n  let breakEarlyObject = { breakEarly: false, i: 0 };\r\n  console.log(\r\n    'Signed txns length',\r\n    signedTxns.length,\r\n    'vs handed in length',\r\n    instructionSet.length,\r\n  );\r\n  for (let i = 0; i < signedTxns.length; i++) {\r\n    const signedTxnPromise = sendSignedTransaction({\r\n      connection,\r\n      signedTransaction: signedTxns[i],\r\n    });\r\n\r\n    signedTxnPromise\r\n      .then(({ txid, slot }) => {\r\n        successCallback(txid, i);\r\n      })\r\n      .catch(reason => {\r\n        // @ts-ignore\r\n        failCallback(signedTxns[i], i);\r\n        if (sequenceType === SequenceType.StopOnFailure) {\r\n          breakEarlyObject.breakEarly = true;\r\n          breakEarlyObject.i = i;\r\n        }\r\n      });\r\n\r\n    if (sequenceType !== SequenceType.Parallel) {\r\n      try {\r\n        await signedTxnPromise;\r\n      } catch (e) {\r\n        console.log('Caught failure', e);\r\n        if (breakEarlyObject.breakEarly) {\r\n          console.log('Died on ', breakEarlyObject.i);\r\n          return breakEarlyObject.i; // Return the txn we failed on by index\r\n        }\r\n      }\r\n    } else {\r\n      pendingTxns.push(signedTxnPromise);\r\n    }\r\n  }\r\n\r\n  if (sequenceType !== SequenceType.Parallel) {\r\n    await Promise.all(pendingTxns);\r\n  }\r\n\r\n  return signedTxns.length;\r\n};\r\n\r\nexport const sendTransaction = async (\r\n  connection: Connection,\r\n  wallet: any,\r\n  instructions: TransactionInstruction[],\r\n  signers: Keypair[],\r\n  awaitConfirmation = true,\r\n  commitment: Commitment = 'singleGossip',\r\n  includesFeePayer: boolean = false,\r\n  block?: BlockhashAndFeeCalculator,\r\n) => {\r\n  if (!wallet.publicKey) throw new WalletNotConnectedError();\r\n\r\n  let transaction = new Transaction();\r\n  instructions.forEach(instruction => transaction.add(instruction));\r\n  transaction.recentBlockhash = (\r\n    block || (await connection.getRecentBlockhash(commitment))\r\n  ).blockhash;\r\n\r\n  if (includesFeePayer) {\r\n    transaction.setSigners(...signers.map(s => s.publicKey));\r\n  } else {\r\n    transaction.setSigners(\r\n      // fee payed by the wallet owner\r\n      wallet.publicKey,\r\n      ...signers.map(s => s.publicKey),\r\n    );\r\n  }\r\n\r\n  if (signers.length > 0) {\r\n    transaction.partialSign(...signers);\r\n  }\r\n  if (!includesFeePayer) {\r\n    transaction = await wallet.signTransaction(transaction);\r\n  }\r\n\r\n  const rawTransaction = transaction.serialize();\r\n  let options = {\r\n    skipPreflight: true,\r\n    commitment,\r\n  };\r\n\r\n  const txid = await connection.sendRawTransaction(rawTransaction, options);\r\n  let slot = 0;\r\n\r\n  if (awaitConfirmation) {\r\n    const confirmation = await awaitTransactionSignatureConfirmation(\r\n      txid,\r\n      DEFAULT_TIMEOUT,\r\n      connection,\r\n      commitment,\r\n    );\r\n\r\n    if (!confirmation)\r\n      throw new Error('Timed out awaiting confirmation on transaction');\r\n    slot = confirmation?.slot || 0;\r\n\r\n    if (confirmation?.err) {\r\n      const errors = await getErrorForTransaction(connection, txid);\r\n\r\n      console.log(errors);\r\n      throw new Error(`Raw transaction ${txid} failed`);\r\n    }\r\n  }\r\n\r\n  return { txid, slot };\r\n};\r\n\r\nexport const sendTransactionWithRetry = async (\r\n  connection: Connection,\r\n  wallet: any,\r\n  instructions: TransactionInstruction[],\r\n  signers: Keypair[],\r\n  commitment: Commitment = 'singleGossip',\r\n  includesFeePayer: boolean = false,\r\n  block?: BlockhashAndFeeCalculator,\r\n  beforeSend?: () => void,\r\n) => {\r\n  if (!wallet.publicKey) throw new WalletNotConnectedError();\r\n\r\n  let transaction = new Transaction();\r\n  instructions.forEach(instruction => transaction.add(instruction));\r\n  transaction.recentBlockhash = (\r\n    block || (await connection.getRecentBlockhash(commitment))\r\n  ).blockhash;\r\n\r\n  if (includesFeePayer) {\r\n    transaction.setSigners(...signers.map(s => s.publicKey));\r\n  } else {\r\n    transaction.setSigners(\r\n      // fee payed by the wallet owner\r\n      wallet.publicKey,\r\n      ...signers.map(s => s.publicKey),\r\n    );\r\n  }\r\n\r\n  if (signers.length > 0) {\r\n    transaction.partialSign(...signers);\r\n  }\r\n  if (!includesFeePayer) {\r\n    transaction = await wallet.signTransaction(transaction);\r\n  }\r\n\r\n  if (beforeSend) {\r\n    beforeSend();\r\n  }\r\n\r\n  const { txid, slot } = await sendSignedTransaction({\r\n    connection,\r\n    signedTransaction: transaction,\r\n  });\r\n\r\n  return { txid, slot };\r\n};\r\n\r\nexport const getUnixTs = () => {\r\n  return new Date().getTime() / 1000;\r\n};\r\n\r\nconst DEFAULT_TIMEOUT = 15000;\r\n\r\nexport async function sendSignedTransaction({\r\n  signedTransaction,\r\n  connection,\r\n  timeout = DEFAULT_TIMEOUT,\r\n}: {\r\n  signedTransaction: Transaction;\r\n  connection: Connection;\r\n  sendingMessage?: string;\r\n  sentMessage?: string;\r\n  successMessage?: string;\r\n  timeout?: number;\r\n}): Promise<{ txid: string; slot: number }> {\r\n  const rawTransaction = signedTransaction.serialize();\r\n  const startTime = getUnixTs();\r\n  let slot = 0;\r\n  const txid: TransactionSignature = await connection.sendRawTransaction(\r\n    rawTransaction,\r\n    {\r\n      skipPreflight: true,\r\n    },\r\n  );\r\n\r\n  console.log('Started awaiting confirmation for', txid);\r\n\r\n  let done = false;\r\n  (async () => {\r\n    while (!done && getUnixTs() - startTime < timeout) {\r\n      connection.sendRawTransaction(rawTransaction, {\r\n        skipPreflight: true,\r\n      });\r\n      await sleep(500);\r\n    }\r\n  })();\r\n  try {\r\n    const confirmation = await awaitTransactionSignatureConfirmation(\r\n      txid,\r\n      timeout,\r\n      connection,\r\n      'recent',\r\n      true,\r\n    );\r\n\r\n    if (!confirmation)\r\n      throw new Error('Timed out awaiting confirmation on transaction');\r\n\r\n    if (confirmation.err) {\r\n      console.error(confirmation.err);\r\n      throw new Error('Transaction failed: Custom instruction error');\r\n    }\r\n\r\n    slot = confirmation?.slot || 0;\r\n  } catch (err: any) {\r\n    console.error('Timeout Error caught', err);\r\n    if (err.timeout) {\r\n      throw new Error('Timed out awaiting confirmation on transaction');\r\n    }\r\n    let simulateResult: SimulatedTransactionResponse | null = null;\r\n    try {\r\n      simulateResult = (\r\n        await simulateTransaction(connection, signedTransaction, 'single')\r\n      ).value;\r\n    } catch (e) {}\r\n    if (simulateResult && simulateResult.err) {\r\n      if (simulateResult.logs) {\r\n        for (let i = simulateResult.logs.length - 1; i >= 0; --i) {\r\n          const line = simulateResult.logs[i];\r\n          if (line.startsWith('Program log: ')) {\r\n            throw new Error(\r\n              'Transaction failed: ' + line.slice('Program log: '.length),\r\n            );\r\n          }\r\n        }\r\n      }\r\n      throw new Error(JSON.stringify(simulateResult.err));\r\n    }\r\n    // throw new Error('Transaction failed');\r\n  } finally {\r\n    done = true;\r\n  }\r\n\r\n  console.log('Latency', txid, getUnixTs() - startTime);\r\n  return { txid, slot };\r\n}\r\n\r\nasync function simulateTransaction(\r\n  connection: Connection,\r\n  transaction: Transaction,\r\n  commitment: Commitment,\r\n): Promise<RpcResponseAndContext<SimulatedTransactionResponse>> {\r\n  // @ts-ignore\r\n  transaction.recentBlockhash = await connection._recentBlockhash(\r\n    // @ts-ignore\r\n    connection._disableBlockhashCaching,\r\n  );\r\n\r\n  const signData = transaction.serializeMessage();\r\n  // @ts-ignore\r\n  const wireTransaction = transaction._serialize(signData);\r\n  const encodedTransaction = wireTransaction.toString('base64');\r\n  const config: any = { encoding: 'base64', commitment };\r\n  const args = [encodedTransaction, config];\r\n\r\n  // @ts-ignore\r\n  const res = await connection._rpcRequest('simulateTransaction', args);\r\n  if (res.error) {\r\n    throw new Error('failed to simulate transaction: ' + res.error.message);\r\n  }\r\n  return res.result;\r\n}\r\n\r\nasync function awaitTransactionSignatureConfirmation(\r\n  txid: TransactionSignature,\r\n  timeout: number,\r\n  connection: Connection,\r\n  commitment: Commitment = 'recent',\r\n  queryStatus = false,\r\n): Promise<SignatureStatus | null | void> {\r\n  let done = false;\r\n  let status: SignatureStatus | null | void = {\r\n    slot: 0,\r\n    confirmations: 0,\r\n    err: null,\r\n  };\r\n  let subId = 0;\r\n  status = await new Promise(async (resolve, reject) => {\r\n    setTimeout(() => {\r\n      if (done) {\r\n        return;\r\n      }\r\n      done = true;\r\n      console.log('Rejecting for timeout...');\r\n      reject({ timeout: true });\r\n    }, timeout);\r\n    try {\r\n      subId = connection.onSignature(\r\n        txid,\r\n        (result, context) => {\r\n          done = true;\r\n          status = {\r\n            err: result.err,\r\n            slot: context.slot,\r\n            confirmations: 0,\r\n          };\r\n          if (result.err) {\r\n            console.log('Rejected via websocket', result.err);\r\n            reject(status);\r\n          } else {\r\n            console.log('Resolved via websocket', result);\r\n            resolve(status);\r\n          }\r\n        },\r\n        commitment,\r\n      );\r\n    } catch (e) {\r\n      done = true;\r\n      console.error('WS error in setup', txid, e);\r\n    }\r\n    while (!done && queryStatus) {\r\n      // eslint-disable-next-line no-loop-func\r\n      (async () => {\r\n        try {\r\n          const signatureStatuses = await connection.getSignatureStatuses([\r\n            txid,\r\n          ]);\r\n          status = signatureStatuses && signatureStatuses.value[0];\r\n          if (!done) {\r\n            if (!status) {\r\n              console.log('REST null result for', txid, status);\r\n            } else if (status.err) {\r\n              console.log('REST error for', txid, status);\r\n              done = true;\r\n              reject(status.err);\r\n            } else if (!status.confirmations) {\r\n              console.log('REST no confirmations for', txid, status);\r\n            } else {\r\n              console.log('REST confirmation for', txid, status);\r\n              done = true;\r\n              resolve(status);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          if (!done) {\r\n            console.log('REST connection error: txid', txid, e);\r\n          }\r\n        }\r\n      })();\r\n      await sleep(2000);\r\n    }\r\n  });\r\n\r\n  //@ts-ignore\r\n  if (connection._signatureSubscriptions[subId])\r\n    connection.removeSignatureListener(subId);\r\n  done = true;\r\n  console.log('Returning status', status);\r\n  return status;\r\n}\r\nexport function sleep(ms: number): Promise<void> {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n","import { useEffect, useMemo, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport {\r\n  CircularProgress,\r\n  Container,\r\n  IconButton,\r\n  Link,\r\n  Slider,\r\n  Snackbar,\r\n} from '@material-ui/core';\r\nimport Button from '@material-ui/core/Button';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { createStyles, Theme } from '@material-ui/core/styles';\r\nimport { PhaseCountdown } from './countdown';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport Alert from '@material-ui/lab/Alert';\r\n\r\nimport * as anchor from '@project-serum/anchor';\r\n\r\nimport { LAMPORTS_PER_SOL } from '@solana/web3.js';\r\n\r\nimport { useWallet } from '@solana/wallet-adapter-react';\r\nimport { WalletDialogButton } from '@solana/wallet-adapter-material-ui';\r\n\r\nimport {\r\n  awaitTransactionSignatureConfirmation,\r\n  CandyMachineAccount,\r\n  getCandyMachineState,\r\n  mintOneToken,\r\n} from './candy-machine';\r\n\r\nimport {\r\n  FairLaunchAccount,\r\n  getFairLaunchState,\r\n  punchTicket,\r\n  purchaseTicket,\r\n  receiveRefund,\r\n} from './fair-launch';\r\n\r\nimport { formatNumber, getAtaForMint, toDate } from './utils';\r\nimport Countdown from 'react-countdown';\r\n\r\nconst ConnectButton = styled(WalletDialogButton)`\r\n  width: 100%;\r\n  height: 60px;\r\n  margin-top: 10px;\r\n  margin-bottom: 5px;\r\n  background: linear-gradient(180deg, #604ae5 0%, #813eee 100%);\r\n  color: white;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n`;\r\n\r\nconst MintContainer = styled.div``; // add your styles here\r\n\r\nconst MintButton = styled(Button)`\r\n  width: 100%;\r\n  height: 60px;\r\n  margin-top: 10px;\r\n  margin-bottom: 5px;\r\n  background: linear-gradient(180deg, #604ae5 0%, #813eee 100%);\r\n  color: white;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n`; // add your styles here\r\n\r\nconst dialogStyles: any = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      margin: 0,\r\n      padding: theme.spacing(2),\r\n    },\r\n    closeButton: {\r\n      position: 'absolute',\r\n      right: theme.spacing(1),\r\n      top: theme.spacing(1),\r\n      color: theme.palette.grey[500],\r\n    },\r\n  });\r\n\r\nconst ValueSlider = styled(Slider)({\r\n  color: '#C0D5FE',\r\n  height: 8,\r\n  '& > *': {\r\n    height: 4,\r\n  },\r\n  '& .MuiSlider-track': {\r\n    border: 'none',\r\n    height: 4,\r\n  },\r\n  '& .MuiSlider-thumb': {\r\n    height: 24,\r\n    width: 24,\r\n    marginTop: -10,\r\n    background: 'linear-gradient(180deg, #604AE5 0%, #813EEE 100%)',\r\n    border: '2px solid currentColor',\r\n    '&:focus, &:hover, &.Mui-active, &.Mui-focusVisible': {\r\n      boxShadow: 'inherit',\r\n    },\r\n    '&:before': {\r\n      display: 'none',\r\n    },\r\n  },\r\n  '& .MuiSlider-valueLabel': {\r\n    '& > *': {\r\n      background: 'linear-gradient(180deg, #604AE5 0%, #813EEE 100%)',\r\n    },\r\n    lineHeight: 1.2,\r\n    fontSize: 12,\r\n    padding: 0,\r\n    width: 32,\r\n    height: 32,\r\n    marginLeft: 9,\r\n  },\r\n});\r\n\r\nenum Phase {\r\n  Phase0,\r\n  Phase1,\r\n  Phase2,\r\n  Lottery,\r\n  Phase3,\r\n  Phase4,\r\n  Unknown,\r\n}\r\n\r\nconst Header = (props: {\r\n  phaseName: string;\r\n  desc: string;\r\n  date: anchor.BN | undefined;\r\n  status?: string;\r\n}) => {\r\n  const { phaseName, desc, date, status } = props;\r\n  return (\r\n    <Grid container justifyContent=\"center\">\r\n      <Grid xs={6} justifyContent=\"center\" direction=\"column\">\r\n        <Typography variant=\"h5\" style={{ fontWeight: 600 }}>\r\n          {phaseName}\r\n        </Typography>\r\n        <Typography variant=\"body1\" color=\"textSecondary\">\r\n          {desc}\r\n        </Typography>\r\n      </Grid>\r\n      <Grid xs={6} container justifyContent=\"flex-end\">\r\n        <PhaseCountdown\r\n          date={toDate(date)}\r\n          style={{ justifyContent: 'flex-end' }}\r\n          status={status || 'COMPLETE'}\r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n\r\nfunction getPhase(\r\n  fairLaunch: FairLaunchAccount | undefined,\r\n  candyMachine: CandyMachineAccount | undefined,\r\n): Phase {\r\n  const curr = new Date().getTime();\r\n\r\n  const phaseOne = toDate(fairLaunch?.state.data.phaseOneStart)?.getTime();\r\n  const phaseOneEnd = toDate(fairLaunch?.state.data.phaseOneEnd)?.getTime();\r\n  const phaseTwoEnd = toDate(fairLaunch?.state.data.phaseTwoEnd)?.getTime();\r\n  const candyMachineGoLive = toDate(candyMachine?.state.goLiveDate)?.getTime();\r\n  if (phaseOne && curr < phaseOne) {\r\n    return Phase.Phase0;\r\n  } else if (phaseOneEnd && curr <= phaseOneEnd) {\r\n    return Phase.Phase1;\r\n  } else if (phaseTwoEnd && curr <= phaseTwoEnd) {\r\n    return Phase.Phase2;\r\n  } else if (\r\n    !fairLaunch?.state.phaseThreeStarted &&\r\n    phaseTwoEnd &&\r\n    curr > phaseTwoEnd\r\n  ) {\r\n    return Phase.Lottery;\r\n  } else if (\r\n    fairLaunch?.state.phaseThreeStarted &&\r\n    candyMachineGoLive &&\r\n    curr > candyMachineGoLive\r\n  ) {\r\n    return Phase.Phase4;\r\n  } else if (fairLaunch?.state.phaseThreeStarted) {\r\n    return Phase.Phase3;\r\n  }\r\n  return Phase.Unknown;\r\n}\r\n\r\nexport interface HomeProps {\r\n  candyMachineId?: anchor.web3.PublicKey;\r\n  fairLaunchId: anchor.web3.PublicKey;\r\n  connection: anchor.web3.Connection;\r\n  startDate: number;\r\n  txTimeout: number;\r\n}\r\n\r\nconst FAIR_LAUNCH_LOTTERY_SIZE =\r\n  8 + // discriminator\r\n  32 + // fair launch\r\n  1 + // bump\r\n  8; // size of bitmask ones\r\n\r\nconst isWinner = (fairLaunch: FairLaunchAccount | undefined): boolean => {\r\n  if (\r\n    !fairLaunch?.lottery.data ||\r\n    !fairLaunch?.lottery.data.length ||\r\n    !fairLaunch?.ticket.data?.seq ||\r\n    !fairLaunch?.state.phaseThreeStarted\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  const myByte =\r\n    fairLaunch.lottery.data[\r\n      FAIR_LAUNCH_LOTTERY_SIZE +\r\n        Math.floor(fairLaunch.ticket.data?.seq.toNumber() / 8)\r\n    ];\r\n\r\n  const positionFromRight = 7 - (fairLaunch.ticket.data?.seq.toNumber() % 8);\r\n  const mask = Math.pow(2, positionFromRight);\r\n  const isWinner = myByte & mask;\r\n  return isWinner > 0;\r\n};\r\n\r\nconst Home = (props: HomeProps) => {\r\n  const [fairLaunchBalance, setFairLaunchBalance] = useState<number>(0);\r\n  const [yourSOLBalance, setYourSOLBalance] = useState<number | null>(null);\r\n\r\n  const [isMinting, setIsMinting] = useState(false); // true when user got to press MINT\r\n  const [contributed, setContributed] = useState(0);\r\n\r\n  const wallet = useWallet();\r\n\r\n  const anchorWallet = useMemo(() => {\r\n    if (\r\n      !wallet ||\r\n      !wallet.publicKey ||\r\n      !wallet.signAllTransactions ||\r\n      !wallet.signTransaction\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    return {\r\n      publicKey: wallet.publicKey,\r\n      signAllTransactions: wallet.signAllTransactions,\r\n      signTransaction: wallet.signTransaction,\r\n    } as anchor.Wallet;\r\n  }, [wallet]);\r\n\r\n  const [alertState, setAlertState] = useState<AlertState>({\r\n    open: false,\r\n    message: '',\r\n    severity: undefined,\r\n  });\r\n\r\n  const [fairLaunch, setFairLaunch] = useState<FairLaunchAccount>();\r\n  const [candyMachine, setCandyMachine] = useState<CandyMachineAccount>();\r\n  const [howToOpen, setHowToOpen] = useState(false);\r\n  const [refundExplainerOpen, setRefundExplainerOpen] = useState(false);\r\n  const [antiRugPolicyOpen, setAnitRugPolicyOpen] = useState(false);\r\n\r\n  const onMint = async () => {\r\n    try {\r\n      setIsMinting(true);\r\n      if (wallet.connected && candyMachine?.program && wallet.publicKey) {\r\n        if (fairLaunch?.ticket.data?.state.unpunched && isWinner(fairLaunch)) {\r\n          await onPunchTicket();\r\n        }\r\n\r\n        const mintTxId = await mintOneToken(candyMachine, wallet.publicKey);\r\n\r\n        const status = await awaitTransactionSignatureConfirmation(\r\n          mintTxId,\r\n          props.txTimeout,\r\n          props.connection,\r\n          'singleGossip',\r\n          false,\r\n        );\r\n\r\n        if (!status?.err) {\r\n          setAlertState({\r\n            open: true,\r\n            message: 'Congratulations! Mint succeeded!',\r\n            severity: 'success',\r\n          });\r\n        } else {\r\n          setAlertState({\r\n            open: true,\r\n            message: 'Mint failed! Please try again!',\r\n            severity: 'error',\r\n          });\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      // TODO: blech:\r\n      let message = error.msg || 'Minting failed! Please try again!';\r\n      if (!error.msg) {\r\n        if (!error.message) {\r\n          message = 'Transaction Timeout! Please try again.';\r\n        } else if (error.message.indexOf('0x138')) {\r\n        } else if (error.message.indexOf('0x137')) {\r\n          message = `SOLD OUT!`;\r\n        } else if (error.message.indexOf('0x135')) {\r\n          message = `Insufficient funds to mint. Please fund your wallet.`;\r\n        }\r\n      } else {\r\n        if (error.code === 311) {\r\n          message = `SOLD OUT!`;\r\n          window.location.reload();\r\n        } else if (error.code === 312) {\r\n          message = `Minting period hasn't started yet.`;\r\n        }\r\n      }\r\n\r\n      setAlertState({\r\n        open: true,\r\n        message,\r\n        severity: 'error',\r\n      });\r\n    } finally {\r\n      setIsMinting(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!anchorWallet) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const balance = await props.connection.getBalance(\r\n          anchorWallet.publicKey,\r\n        );\r\n        setYourSOLBalance(balance);\r\n\r\n        const state = await getFairLaunchState(\r\n          anchorWallet,\r\n          props.fairLaunchId,\r\n          props.connection,\r\n        );\r\n\r\n        setFairLaunch(state);\r\n\r\n        try {\r\n          if (state.state.tokenMint) {\r\n            const fairLaunchBalance =\r\n              await props.connection.getTokenAccountBalance(\r\n                (\r\n                  await getAtaForMint(\r\n                    state.state.tokenMint,\r\n                    anchorWallet.publicKey,\r\n                  )\r\n                )[0],\r\n              );\r\n\r\n            if (fairLaunchBalance.value) {\r\n              setFairLaunchBalance(fairLaunchBalance.value.uiAmount || 0);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          console.log('Problem getting fair launch token balance');\r\n          console.log(e);\r\n        }\r\n        if (contributed === 0) {\r\n          const phase = getPhase(state, undefined);\r\n\r\n          if (phase === Phase.Phase1) {\r\n            const ticks =\r\n              (state.state.data.priceRangeEnd.toNumber() -\r\n                state.state.data.priceRangeStart.toNumber()) /\r\n              state.state.data.tickSize.toNumber();\r\n            const randomTick = Math.round(Math.random() * ticks);\r\n\r\n            setContributed(\r\n              (state.state.data.priceRangeStart.toNumber() +\r\n                randomTick * state.state.data.tickSize.toNumber()) /\r\n                LAMPORTS_PER_SOL,\r\n            );\r\n          } else {\r\n            setContributed(\r\n              (\r\n                state.state.currentMedian || state.state.data.priceRangeStart\r\n              ).toNumber() / LAMPORTS_PER_SOL,\r\n            );\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.log('Problem getting fair launch state');\r\n        console.log(e);\r\n      }\r\n      if (props.candyMachineId) {\r\n        try {\r\n          const cndy = await getCandyMachineState(\r\n            anchorWallet,\r\n            props.candyMachineId,\r\n            props.connection,\r\n          );\r\n          setCandyMachine(cndy);\r\n        } catch (e) {\r\n          console.log('Problem getting candy machine state');\r\n          console.log(e);\r\n        }\r\n      } else {\r\n        console.log('No candy machine detected in configuration.');\r\n      }\r\n    })();\r\n  }, [\r\n    anchorWallet,\r\n    props.candyMachineId,\r\n    props.connection,\r\n    props.fairLaunchId,\r\n    contributed,\r\n  ]);\r\n\r\n  const min = formatNumber.asNumber(fairLaunch?.state.data.priceRangeStart);\r\n  const max = formatNumber.asNumber(fairLaunch?.state.data.priceRangeEnd);\r\n  const step = formatNumber.asNumber(fairLaunch?.state.data.tickSize);\r\n  const median = formatNumber.asNumber(fairLaunch?.state.currentMedian);\r\n  const phase = getPhase(fairLaunch, candyMachine);\r\n  console.log('Phase', phase);\r\n  const marks = [\r\n    {\r\n      value: min || 0,\r\n      label: `${min} SOL`,\r\n    },\r\n    // TODO:L\r\n    ...(phase === Phase.Phase1\r\n      ? []\r\n      : [\r\n          {\r\n            value: median || 0,\r\n            label: `${median}`,\r\n          },\r\n        ]),\r\n    // display user comitted value\r\n    // {\r\n    //   value: 37,\r\n    //   label: '37°C',\r\n    // },\r\n    {\r\n      value: max || 0,\r\n      label: `${max} SOL`,\r\n    },\r\n  ].filter(_ => _ !== undefined && _.value !== 0) as any;\r\n\r\n  const onDeposit = async () => {\r\n    if (!anchorWallet) {\r\n      return;\r\n    }\r\n\r\n    console.log('deposit');\r\n    setIsMinting(true);\r\n    try {\r\n      await purchaseTicket(contributed, anchorWallet, fairLaunch);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: `Congratulations! Bid ${\r\n          fairLaunch?.ticket.data ? 'updated' : 'inserted'\r\n        }!`,\r\n        severity: 'success',\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: 'Something went wrong.',\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n  const onRugRefund = async () => {\r\n    if (!anchorWallet) {\r\n      return;\r\n    }\r\n\r\n    console.log('refund');\r\n    try {\r\n      setIsMinting(true);\r\n      await receiveRefund(anchorWallet, fairLaunch);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message:\r\n          'Congratulations! You have received a refund. This is an irreversible action.',\r\n        severity: 'success',\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: 'Something went wrong.',\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n  const onRefundTicket = async () => {\r\n    if (!anchorWallet) {\r\n      return;\r\n    }\r\n\r\n    console.log('refund');\r\n    try {\r\n      setIsMinting(true);\r\n      await purchaseTicket(0, anchorWallet, fairLaunch);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message:\r\n          'Congratulations! Funds withdrawn. This is an irreversible action.',\r\n        severity: 'success',\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: 'Something went wrong.',\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const onPunchTicket = async () => {\r\n    if (!anchorWallet || !fairLaunch || !fairLaunch.ticket) {\r\n      return;\r\n    }\r\n\r\n    console.log('punch');\r\n    setIsMinting(true);\r\n    try {\r\n      await punchTicket(anchorWallet, fairLaunch);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: 'Congratulations! Ticket punched!',\r\n        severity: 'success',\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n      setIsMinting(false);\r\n      setAlertState({\r\n        open: true,\r\n        message: 'Something went wrong.',\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const candyMachinePredatesFairLaunch =\r\n    candyMachine?.state.goLiveDate &&\r\n    fairLaunch?.state.data.phaseTwoEnd &&\r\n    candyMachine?.state.goLiveDate.lt(fairLaunch?.state.data.phaseTwoEnd);\r\n\r\n  const notEnoughSOL = !!(\r\n    yourSOLBalance != null &&\r\n    fairLaunch?.state.data.priceRangeStart &&\r\n    fairLaunch?.state.data.fee &&\r\n    yourSOLBalance + (fairLaunch?.ticket?.data?.amount.toNumber() || 0) <\r\n      contributed * LAMPORTS_PER_SOL +\r\n        fairLaunch?.state.data.fee.toNumber() +\r\n        0.01\r\n  );\r\n\r\n  return (\r\n    <Container style={{ marginTop: 100 }}>\r\n      <Container maxWidth=\"xs\" style={{ position: 'relative' }}>\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            flexDirection: 'row',\r\n            justifyContent: 'flex-end',\r\n          }}\r\n        >\r\n        </div>\r\n      </Container>\r\n      <Container maxWidth=\"xs\" style={{ position: 'relative' }}>\r\n        <Paper\r\n          style={{ padding: 24, backgroundColor: '#151A1F', borderRadius: 6 }}\r\n        >\r\n          <Grid container justifyContent=\"center\" direction=\"column\">\r\n            <Typography>\r\n            You are bidding on the opportunity to be in the running \r\n            for one of four Duke NFTs - these super NFTs will add 1% to\r\n            your ENTIRE TEAM's vote, whichever you choose. (either frien or unfrie)\r\n            These benefits accumulate with other modifiers.\r\n            </Typography>\r\n            {phase === Phase.Phase0 && (\r\n              <Header\r\n                phaseName={'Phase 0'}\r\n                desc={'Anticipation Phase'}\r\n                date={fairLaunch?.state.data.phaseOneStart}\r\n              />\r\n            )}\r\n            {phase === Phase.Phase1 && (\r\n              <Header\r\n                phaseName={'Phase 1'}\r\n                desc={'Set price phase'}\r\n                date={fairLaunch?.state.data.phaseOneEnd}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Phase2 && (\r\n              <Header\r\n                phaseName={'Phase 2'}\r\n                desc={'Grace period'}\r\n                date={fairLaunch?.state.data.phaseTwoEnd}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Lottery && (\r\n              <Header\r\n                phaseName={'Phase 3'}\r\n                desc={'Raffle in progress'}\r\n                date={fairLaunch?.state.data.phaseTwoEnd.add(\r\n                  fairLaunch?.state.data.lotteryDuration,\r\n                )}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Phase3 && !candyMachine && (\r\n              <Header\r\n                phaseName={'Phase 3'}\r\n                desc={'Raffle finished!'}\r\n                date={fairLaunch?.state.data.phaseTwoEnd}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Phase3 && candyMachine && (\r\n              <Header\r\n                phaseName={'Phase 3'}\r\n                desc={'Minting starts in...'}\r\n                date={candyMachine?.state.goLiveDate}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Unknown && !candyMachine && (\r\n              <Header\r\n                phaseName={'Loading...'}\r\n                desc={'Waiting for you to connect your wallet.'}\r\n                date={undefined}\r\n              />\r\n            )}\r\n\r\n            {phase === Phase.Phase4 && (\r\n              <Header\r\n                phaseName={\r\n                  candyMachinePredatesFairLaunch ? 'Phase 3' : 'Phase 4'\r\n                }\r\n                desc={'Candy Time 🍬 🍬 🍬'}\r\n                date={candyMachine?.state.goLiveDate}\r\n                status=\"LIVE\"\r\n              />\r\n            )}\r\n\r\n            {fairLaunch && (\r\n              <Grid\r\n                container\r\n                direction=\"column\"\r\n                justifyContent=\"center\"\r\n                alignItems=\"center\"\r\n                style={{\r\n                  height: 200,\r\n                  marginTop: 20,\r\n                  marginBottom: 20,\r\n                  background: '#384457',\r\n                  borderRadius: 6,\r\n                }}\r\n              >\r\n                {fairLaunch.ticket.data ? (\r\n                  <>\r\n                    <Typography>Your bid</Typography>\r\n                    <Typography variant=\"h6\" style={{ fontWeight: 900 }}>\r\n                      {formatNumber.format(\r\n                        (fairLaunch?.ticket.data?.amount.toNumber() || 0) /\r\n                          LAMPORTS_PER_SOL,\r\n                      )}{' '}\r\n                      SOL\r\n                    </Typography>\r\n                  </>\r\n                ) : [Phase.Phase0, Phase.Phase1].includes(phase) ? (\r\n                  <Typography>\r\n                    If you want to win, the onlye surefire way of ensuring success\r\n                    is to make the average price so high that there are less people \r\n                    eligible for the raffle. Enter a bid that outprices people. <br />\r\n                    {fairLaunch?.state?.data?.fee && (\r\n                      <span>\r\n                        <b>\r\n                          All initial bids will incur a ◎{' '}\r\n                          {fairLaunch?.state?.data?.fee.toNumber() /\r\n                            LAMPORTS_PER_SOL}{' '}\r\n                          fee.\r\n                        </b>\r\n                      </span>\r\n                    )}\r\n                  </Typography>\r\n                ) : (\r\n                  <Typography>\r\n                    You didn't participate in this raffle.\r\n                  </Typography>\r\n                )}\r\n              </Grid>\r\n            )}\r\n\r\n            {fairLaunch && (\r\n              <>\r\n                {[\r\n                  Phase.Phase1,\r\n                  Phase.Phase2,\r\n                  Phase.Phase3,\r\n                  Phase.Lottery,\r\n                ].includes(phase) &&\r\n                  fairLaunch?.ticket?.data?.state.withdrawn && (\r\n                    <div style={{ paddingTop: '15px' }}>\r\n                      <Alert severity=\"error\">\r\n                        Your bid was withdrawn and cannot be adjusted or\r\n                        re-inserted.\r\n                      </Alert>\r\n                    </div>\r\n                  )}\r\n                {[Phase.Phase2].includes(phase) &&\r\n                  fairLaunch.state.currentMedian &&\r\n                  fairLaunch?.ticket?.data?.amount &&\r\n                  !fairLaunch?.ticket?.data?.state.withdrawn &&\r\n                  fairLaunch.state.currentMedian.gt(\r\n                    fairLaunch?.ticket?.data?.amount,\r\n                  ) && (\r\n                    <div style={{ paddingTop: '15px' }}>\r\n                      <Alert severity=\"warning\">\r\n                        Your bid is currently below the median and will not be\r\n                        eligible for the raffle.\r\n                      </Alert>\r\n                    </div>\r\n                  )}\r\n                {[Phase.Phase3, Phase.Lottery].includes(phase) &&\r\n                  fairLaunch.state.currentMedian &&\r\n                  fairLaunch?.ticket?.data?.amount &&\r\n                  !fairLaunch?.ticket?.data?.state.withdrawn &&\r\n                  fairLaunch.state.currentMedian.gt(\r\n                    fairLaunch?.ticket?.data?.amount,\r\n                  ) && (\r\n                    <div style={{ paddingTop: '15px' }}>\r\n                      <Alert severity=\"error\">\r\n                        Your bid was below the median and was not included in\r\n                        the raffle. You may click <em>Withdraw</em> when the\r\n                        raffle ends or you will be automatically issued one when\r\n                        the Fair Launch authority withdraws from the treasury.\r\n                      </Alert>\r\n                    </div>\r\n                  )}\r\n                {notEnoughSOL && (\r\n                  <Alert severity=\"error\">\r\n                    You do not have enough SOL in your account to place this\r\n                    bid.\r\n                  </Alert>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            {[Phase.Phase1, Phase.Phase2].includes(phase) && (\r\n              <>\r\n                <Grid style={{ marginTop: 40, marginBottom: 20 }}>\r\n                  {contributed > 0 ? (\r\n                    <ValueSlider\r\n                      min={min}\r\n                      marks={marks}\r\n                      max={max}\r\n                      step={step}\r\n                      value={contributed}\r\n                      onChange={(ev, val) => setContributed(val as any)}\r\n                      valueLabelDisplay=\"auto\"\r\n                      style={{\r\n                        width: 'calc(100% - 40px)',\r\n                        marginLeft: 20,\r\n                        height: 30,\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div\r\n                      style={{\r\n                        display: 'flex',\r\n                        justifyContent: 'center',\r\n                        alignItems: 'center',\r\n                      }}\r\n                    >\r\n                      <CircularProgress />\r\n                    </div>\r\n                  )}\r\n                </Grid>\r\n              </>\r\n            )}\r\n\r\n            {!wallet.connected ? (\r\n              <ConnectButton>\r\n                Connect{' '}\r\n                {[Phase.Phase1].includes(phase) ? 'to bid' : 'to see status'}\r\n              </ConnectButton>\r\n            ) : (\r\n              <div>\r\n                {[Phase.Phase1, Phase.Phase2].includes(phase) && (\r\n                  <>\r\n                    <MintButton\r\n                      onClick={onDeposit}\r\n                      variant=\"contained\"\r\n                      disabled={\r\n                        isMinting ||\r\n                        (!fairLaunch?.ticket.data && phase === Phase.Phase2) ||\r\n                        notEnoughSOL\r\n                      }\r\n                    >\r\n                      {isMinting ? (\r\n                        <CircularProgress />\r\n                      ) : !fairLaunch?.ticket.data ? (\r\n                        'Place bid'\r\n                      ) : (\r\n                        'Change bid'\r\n                      )}\r\n                      {}\r\n                    </MintButton>\r\n                  </>\r\n                )}\r\n\r\n                {[Phase.Phase3].includes(phase) && (\r\n                  <>\r\n                    {isWinner(fairLaunch) && (\r\n                      <MintButton\r\n                        onClick={onPunchTicket}\r\n                        variant=\"contained\"\r\n                        disabled={\r\n                          fairLaunch?.ticket.data?.state.punched !== undefined\r\n                        }\r\n                      >\r\n                        {isMinting ? <CircularProgress /> : 'Punch Ticket'}\r\n                      </MintButton>\r\n                    )}\r\n\r\n                    {!isWinner(fairLaunch) && (\r\n                      <MintButton\r\n                        onClick={onRefundTicket}\r\n                        variant=\"contained\"\r\n                        disabled={\r\n                          isMinting ||\r\n                          fairLaunch?.ticket.data === undefined ||\r\n                          fairLaunch?.ticket.data?.state.withdrawn !== undefined\r\n                        }\r\n                      >\r\n                        {isMinting ? <CircularProgress /> : 'Withdraw'}\r\n                      </MintButton>\r\n                    )}\r\n                  </>\r\n                )}\r\n\r\n                {phase === Phase.Phase4 && (\r\n                  <>\r\n                    {(!fairLaunch ||\r\n                      isWinner(fairLaunch) ||\r\n                      fairLaunchBalance > 0) && (\r\n                      <MintContainer>\r\n                        <MintButton\r\n                          disabled={\r\n                            candyMachine?.state.isSoldOut ||\r\n                            isMinting ||\r\n                            !candyMachine?.state.isActive ||\r\n                            (fairLaunch?.ticket?.data?.state.punched &&\r\n                              fairLaunchBalance === 0)\r\n                          }\r\n                          onClick={onMint}\r\n                          variant=\"contained\"\r\n                        >\r\n                          {fairLaunch?.ticket?.data?.state.punched &&\r\n                          fairLaunchBalance === 0 ? (\r\n                            'MINTED'\r\n                          ) : candyMachine?.state.isSoldOut ? (\r\n                            'SOLD OUT'\r\n                          ) : isMinting ? (\r\n                            <CircularProgress />\r\n                          ) : (\r\n                            'MINT'\r\n                          )}\r\n                        </MintButton>\r\n                      </MintContainer>\r\n                    )}\r\n\r\n                    {!isWinner(fairLaunch) && (\r\n                      <MintButton\r\n                        onClick={onRefundTicket}\r\n                        variant=\"contained\"\r\n                        disabled={\r\n                          isMinting ||\r\n                          fairLaunch?.ticket.data === undefined ||\r\n                          fairLaunch?.ticket.data?.state.withdrawn !== undefined\r\n                        }\r\n                      >\r\n                        {isMinting ? <CircularProgress /> : 'Withdraw'}\r\n                      </MintButton>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            <Grid\r\n              container\r\n              justifyContent=\"space-between\"\r\n              color=\"textSecondary\"\r\n            >\r\n              <Link\r\n                component=\"button\"\r\n                variant=\"body2\"\r\n                color=\"textSecondary\"\r\n                align=\"left\"\r\n                onClick={() => {\r\n                  setHowToOpen(true);\r\n                }}\r\n              >\r\n                How this raffle works\r\n              </Link>\r\n              {fairLaunch?.ticket.data && (\r\n                <Link\r\n                  component=\"button\"\r\n                  variant=\"body2\"\r\n                  color=\"textSecondary\"\r\n                  align=\"right\"\r\n                  onClick={() => {\r\n                    if (\r\n                      !fairLaunch ||\r\n                      phase === Phase.Lottery ||\r\n                      isWinner(fairLaunch) ||\r\n                      fairLaunchBalance > 0\r\n                    ) {\r\n                      setRefundExplainerOpen(true);\r\n                    } else {\r\n                      onRefundTicket();\r\n                    }\r\n                  }}\r\n                >\r\n                  Withdraw funds\r\n                </Link>\r\n              )}\r\n            </Grid>\r\n            <Dialog\r\n              open={refundExplainerOpen}\r\n              onClose={() => setRefundExplainerOpen(false)}\r\n              PaperProps={{\r\n                style: { backgroundColor: '#222933', borderRadius: 6 },\r\n              }}\r\n            >\r\n              <MuiDialogContent style={{ padding: 24 }}>\r\n                During raffle phases, or if you are a winner, or if this website\r\n                is not configured to be a fair launch but simply a candy\r\n                machine, refunds are disallowed.\r\n              </MuiDialogContent>\r\n            </Dialog>\r\n            <Dialog\r\n              open={antiRugPolicyOpen}\r\n              onClose={() => {\r\n                setAnitRugPolicyOpen(false);\r\n              }}\r\n              PaperProps={{\r\n                style: { backgroundColor: '#222933', borderRadius: 6 },\r\n              }}\r\n            >\r\n              <MuiDialogContent style={{ padding: 24 }}>\r\n                {!fairLaunch?.state.data.antiRugSetting && (\r\n                  <span>This Fair Launch has no anti-rug settings.</span>\r\n                )}\r\n                {fairLaunch?.state.data.antiRugSetting &&\r\n                  fairLaunch.state.data.antiRugSetting.selfDestructDate && (\r\n                    <div>\r\n                      <h3>Anti-Rug Policy</h3>\r\n                      <p>\r\n                        This raffle is governed by a smart contract to prevent\r\n                        the artist from running away with your money.\r\n                      </p>\r\n                      <p>How it works:</p>\r\n                      This project will retain{' '}\r\n                      {fairLaunch.state.data.antiRugSetting.reserveBp / 100}% (◎{' '}\r\n                      {(fairLaunch?.treasury *\r\n                        fairLaunch.state.data.antiRugSetting.reserveBp) /\r\n                        (LAMPORTS_PER_SOL * 10000)}\r\n                      ) of the pledged amount in a locked state until all but{' '}\r\n                      {fairLaunch.state.data.antiRugSetting.tokenRequirement.toNumber()}{' '}\r\n                      NFTs (out of up to{' '}\r\n                      {fairLaunch.state.data.numberOfTokens.toNumber()}) have\r\n                      been minted.\r\n                      <p>\r\n                        If more than{' '}\r\n                        {fairLaunch.state.data.antiRugSetting.tokenRequirement.toNumber()}{' '}\r\n                        NFTs remain as of{' '}\r\n                        {toDate(\r\n                          fairLaunch.state.data.antiRugSetting.selfDestructDate,\r\n                        )?.toLocaleDateString()}{' '}\r\n                        at{' '}\r\n                        {toDate(\r\n                          fairLaunch.state.data.antiRugSetting.selfDestructDate,\r\n                        )?.toLocaleTimeString()}\r\n                        , you will have the option to get a refund of{' '}\r\n                        {fairLaunch.state.data.antiRugSetting.reserveBp / 100}%\r\n                        of the cost of your token.\r\n                      </p>\r\n                      {fairLaunch?.ticket?.data &&\r\n                        !fairLaunch?.ticket?.data.state.withdrawn && (\r\n                          <MintButton\r\n                            onClick={onRugRefund}\r\n                            variant=\"contained\"\r\n                            disabled={\r\n                              !!!fairLaunch.ticket.data ||\r\n                              !fairLaunch.ticket.data.state.punched ||\r\n                              Date.now() / 1000 <\r\n                                fairLaunch.state.data.antiRugSetting.selfDestructDate.toNumber()\r\n                            }\r\n                          >\r\n                            {isMinting ? (\r\n                              <CircularProgress />\r\n                            ) : Date.now() / 1000 <\r\n                              fairLaunch.state.data.antiRugSetting.selfDestructDate.toNumber() ? (\r\n                              <span>\r\n                                Refund in...\r\n                                <Countdown\r\n                                  date={toDate(\r\n                                    fairLaunch.state.data.antiRugSetting\r\n                                      .selfDestructDate,\r\n                                  )}\r\n                                />\r\n                              </span>\r\n                            ) : (\r\n                              'Refund'\r\n                            )}\r\n                            {}\r\n                          </MintButton>\r\n                        )}\r\n                      <div style={{ textAlign: 'center', marginTop: '-5px' }}>\r\n                        {fairLaunch?.ticket?.data &&\r\n                          !fairLaunch?.ticket?.data?.state.punched && (\r\n                            <small>\r\n                              You currently have a ticket but it has not been\r\n                              punched yet, so cannot be refunded.\r\n                            </small>\r\n                          )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n              </MuiDialogContent>\r\n            </Dialog>\r\n            <Dialog\r\n              open={howToOpen}\r\n              onClose={() => setHowToOpen(false)}\r\n              PaperProps={{\r\n                style: { backgroundColor: '#222933', borderRadius: 6 },\r\n              }}\r\n            >\r\n              <MuiDialogTitle\r\n                disableTypography\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'space-between',\r\n                }}\r\n              >\r\n                <Link\r\n                  component=\"button\"\r\n                  variant=\"h6\"\r\n                  color=\"textSecondary\"\r\n                  onClick={() => {\r\n                    setHowToOpen(true);\r\n                  }}\r\n                >\r\n                  How it works\r\n                </Link>\r\n                <IconButton\r\n                  aria-label=\"close\"\r\n                  className={dialogStyles.closeButton}\r\n                  onClick={() => setHowToOpen(false)}\r\n                >\r\n                  <CloseIcon />\r\n                </IconButton>\r\n              </MuiDialogTitle>\r\n              <MuiDialogContent>\r\n                <Typography variant=\"h6\">\r\n                  Phase 1 - Set the fair price:\r\n                </Typography>\r\n                <Typography gutterBottom color=\"textSecondary\">\r\n                  You are trying to make sure that your bid ensures you\r\n                  get a ticket, and there's 100% chance of that. Until we have \r\n                  four bids, this means the obvious play is to bid as little as\r\n                  possible - but if there are more than 4 bids (or 40x) then \r\n                  you'll need to update your srategy.\r\n                  {' '}\r\n                  {fairLaunch?.state?.data?.fee && (\r\n                    <span>\r\n                      <b>\r\n                        All bids will incur a ◎{' '}\r\n                        {fairLaunch?.state?.data?.fee.toNumber() /\r\n                          LAMPORTS_PER_SOL}{' '}\r\n                        fee.\r\n                      </b>\r\n                    </span>\r\n                  )}\r\n                </Typography>\r\n                <Typography variant=\"h6\">Phase 2 - Grace period:</Typography>\r\n                <Typography gutterBottom color=\"textSecondary\">\r\n                  If your bid was at or above the fair price, you automatically\r\n                  get a raffle ticket at that price. There's nothing else you\r\n                  need to do. Your excess SOL will be returned to you when the\r\n                  Fair Launch authority withdraws from the treasury. If your bid\r\n                  is below the median price, you can still opt in at the fair\r\n                  price during this phase.\r\n                </Typography>\r\n                {candyMachinePredatesFairLaunch ? (\r\n                  <>\r\n                    <Typography variant=\"h6\">\r\n                      Phase 3 - The Candy Machine:\r\n                    </Typography>\r\n                    <Typography gutterBottom color=\"textSecondary\">\r\n                      Everyone who got a raffle ticket at the fair price is\r\n                      entered to win an NFT. If you win an NFT, congrats. If you\r\n                      don’t, no worries, your SOL will go right back into your\r\n                      wallet.\r\n                    </Typography>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Typography variant=\"h6\">Phase 3 - The Lottery:</Typography>\r\n                    <Typography gutterBottom color=\"textSecondary\">\r\n                      Everyone who got a raffle ticket at the fair price is\r\n                      entered to win a Fair Launch Token that entitles them to\r\n                      an NFT at a later date using a Candy Machine here. If you\r\n                      don’t win, no worries, your SOL will go right back into\r\n                      your wallet.\r\n                    </Typography>\r\n                    <Typography variant=\"h6\">\r\n                      Phase 4 - The Candy Machine:\r\n                    </Typography>\r\n                    <Typography gutterBottom color=\"textSecondary\">\r\n                      On{' '}\r\n                      {candyMachine?.state.goLiveDate\r\n                        ? toDate(\r\n                            candyMachine?.state.goLiveDate,\r\n                          )?.toLocaleString()\r\n                        : ' some later date'}\r\n                      , you will be able to exchange your Fair Launch token for\r\n                      an NFT using the Candy Machine at this site by pressing\r\n                      the Mint Button.\r\n                    </Typography>\r\n                  </>\r\n                )}\r\n              </MuiDialogContent>\r\n            </Dialog>\r\n\r\n            {/* {wallet.connected && (\r\n              <p>\r\n                Address: {shortenAddress(wallet.publicKey?.toBase58() || '')}\r\n              </p>\r\n            )}\r\n\r\n            {wallet.connected && (\r\n              <p>Balance: {(balance || 0).toLocaleString()} SOL</p>\r\n            )} */}\r\n          </Grid>\r\n        </Paper>\r\n      </Container>\r\n\r\n      {fairLaunch && (\r\n        <Container\r\n          maxWidth=\"xs\"\r\n          style={{ position: 'relative', marginTop: 10 }}\r\n        >\r\n          <div style={{ margin: 20 }}>\r\n            <Grid container direction=\"row\" wrap=\"nowrap\">\r\n              <Grid container md={4} direction=\"column\">\r\n                <Typography variant=\"body2\" color=\"textSecondary\">\r\n                  Bids\r\n                </Typography>\r\n                <Typography\r\n                  variant=\"h6\"\r\n                  color=\"textPrimary\"\r\n                  style={{ fontWeight: 'bold' }}\r\n                >\r\n                  {fairLaunch?.state.numberTicketsSold.toNumber() || 0}\r\n                </Typography>\r\n              </Grid>\r\n              <Grid container md={4} direction=\"column\">\r\n                <Typography variant=\"body2\" color=\"textSecondary\">\r\n                  Median bid\r\n                </Typography>\r\n                <Typography\r\n                  variant=\"h6\"\r\n                  color=\"textPrimary\"\r\n                  style={{ fontWeight: 'bold' }}\r\n                >\r\n                  ◎{' '}\r\n                  {phase === Phase.Phase0 || phase === Phase.Phase1\r\n                    ? '???'\r\n                    : formatNumber.format(median)}\r\n                </Typography>\r\n              </Grid>\r\n              <Grid container md={4} direction=\"column\">\r\n                <Typography variant=\"body2\" color=\"textSecondary\">\r\n                  Total raised\r\n                </Typography>\r\n                <Typography\r\n                  variant=\"h6\"\r\n                  color=\"textPrimary\"\r\n                  style={{ fontWeight: 'bold' }}\r\n                >\r\n                  ◎{' '}\r\n                  {formatNumber.format(\r\n                    (fairLaunch?.treasury || 0) / LAMPORTS_PER_SOL,\r\n                  )}\r\n                </Typography>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </Container>\r\n      )}\r\n      <Snackbar\r\n        open={alertState.open}\r\n        autoHideDuration={6000}\r\n        onClose={() => setAlertState({ ...alertState, open: false })}\r\n      >\r\n        <Alert\r\n          onClose={() => setAlertState({ ...alertState, open: false })}\r\n          severity={alertState.severity}\r\n        >\r\n          {alertState.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n};\r\n\r\ninterface AlertState {\r\n  open: boolean;\r\n  message: string;\r\n  severity: 'success' | 'info' | 'warning' | 'error' | undefined;\r\n}\r\n\r\nexport default Home;\r\n","import { Paper } from '@material-ui/core';\r\nimport Countdown from 'react-countdown';\r\nimport { Theme, createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport { useState } from 'react';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: 'flex',\r\n      padding: theme.spacing(0),\r\n      '& > *': {\r\n        margin: theme.spacing(0.5),\r\n        marginRight: 0,\r\n        width: theme.spacing(6),\r\n        height: theme.spacing(6),\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignContent: 'center',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        background: '#384457',\r\n        color: 'white',\r\n        borderRadius: 5,\r\n        fontSize: 10,\r\n      },\r\n    },\r\n    done: {\r\n      display: 'flex',\r\n      margin: theme.spacing(1),\r\n      marginRight: 0,\r\n      padding: theme.spacing(1),\r\n      flexDirection: 'column',\r\n      alignContent: 'center',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      background: '#384457',\r\n      color: 'white',\r\n      borderRadius: 5,\r\n      fontWeight: 'bold',\r\n      fontSize: 18,\r\n    },\r\n    item: {\r\n      fontWeight: 'bold',\r\n      fontSize: 18,\r\n    }\r\n  }),\r\n);\r\n\r\n\r\ninterface PhaseCountdownProps {\r\n  date: Date | undefined;\r\n  style?: React.CSSProperties;\r\n  status?: string;\r\n  onComplete?: () => void;\r\n  start?: Date;\r\n  end?: Date;\r\n}\r\n\r\ninterface CountdownRender {\r\n  days: number;\r\n  hours: number;\r\n  minutes: number;\r\n  seconds: number;\r\n  completed: boolean;\r\n}\r\n\r\nexport const PhaseCountdown: React.FC<PhaseCountdownProps> = ({\r\n  date,\r\n  status,\r\n  style,\r\n  start,\r\n  end,\r\n  onComplete,\r\n}) => {\r\n  const classes = useStyles();\r\n\r\n  const [isFixed, setIsFixed] = useState(start && end && date ? start.getTime() - Date.now() < 0 : false);\r\n\r\n  const renderCountdown = ({ days, hours, minutes, seconds, completed }: CountdownRender) => {\r\n    hours += days * 24\r\n    if (completed) {\r\n      return status ? <span className={classes.done}  >{status}</span> : null;\r\n    } else {\r\n      return (\r\n        <div className={classes.root} style={style} >\r\n          {isFixed && <Paper elevation={0}>\r\n            <span className={classes.item}>\r\n              +\r\n            </span>\r\n          </Paper>}\r\n          <Paper elevation={0}>\r\n            <span className={classes.item}>\r\n              {hours < 10 ? `0${hours}` : hours}\r\n            </span>\r\n            <span>hrs</span>\r\n          </Paper>\r\n          <Paper elevation={0}>\r\n            <span className={classes.item}>\r\n              {minutes < 10 ? `0${minutes}` : minutes}\r\n            </span>\r\n            <span>mins</span>\r\n          </Paper>\r\n          <Paper elevation={0}>\r\n            <span className={classes.item}>\r\n              {seconds < 10 ? `0${seconds}` : seconds}\r\n            </span>\r\n            <span>secs</span>\r\n          </Paper>\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n\r\n  if (date && start && end) {\r\n    if (isFixed) {\r\n      <Countdown\r\n        date={start}\r\n        now={() => end.getTime()}\r\n        onComplete={() => setIsFixed(false)}\r\n        renderer={renderCountdown}\r\n      />\r\n    }\r\n  }\r\n\r\n  if (date) {\r\n    return (\r\n      <Countdown\r\n        date={date}\r\n        onComplete={onComplete}\r\n        renderer={renderCountdown}\r\n      />\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n","import React, { useContext, useEffect, useMemo, useRef } from 'react';\r\nimport confetti from 'canvas-confetti';\r\n\r\nexport interface ConfettiContextState {\r\n  dropConfetti: () => void;\r\n}\r\n\r\nconst ConfettiContext = React.createContext<ConfettiContextState | null>(null);\r\n\r\nexport const ConfettiProvider = ({ children = null as any }) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>();\r\n  const confettiRef = useRef<confetti.CreateTypes>();\r\n\r\n  const dropConfetti = useMemo(\r\n    () => () => {\r\n      if (confettiRef.current && canvasRef.current) {\r\n        canvasRef.current.style.visibility = 'visible';\r\n        confettiRef\r\n          .current({\r\n            particleCount: 400,\r\n            spread: 160,\r\n            origin: { y: 0.3 },\r\n          })\r\n          ?.finally(() => {\r\n            if (canvasRef.current) {\r\n              canvasRef.current.style.visibility = 'hidden';\r\n            }\r\n          });\r\n      }\r\n    },\r\n    [],\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (canvasRef.current && !confettiRef.current) {\r\n      canvasRef.current.style.visibility = 'hidden';\r\n      confettiRef.current = confetti.create(canvasRef.current, {\r\n        resize: true,\r\n        useWorker: true,\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const canvasStyle: React.CSSProperties = {\r\n    width: '100vw',\r\n    height: '100vh',\r\n    position: 'absolute',\r\n    zIndex: 1,\r\n    top: 0,\r\n    left: 0,\r\n  };\r\n\r\n  return (\r\n    <ConfettiContext.Provider value={{ dropConfetti }}>\r\n      <canvas ref={canvasRef as any} style={canvasStyle} />\r\n      {children}\r\n    </ConfettiContext.Provider>\r\n  );\r\n};\r\n\r\nexport const Confetti = () => {\r\n  const { dropConfetti } = useConfetti();\r\n\r\n  useEffect(() => {\r\n    dropConfetti();\r\n  }, [dropConfetti]);\r\n\r\n  return <></>;\r\n};\r\n\r\nexport const useConfetti = () => {\r\n  const context = useContext(ConfettiContext);\r\n  return context as ConfettiContextState;\r\n};\r\n","import './App.css';\r\nimport { useMemo } from 'react';\r\n\r\nimport Home from './Home';\r\n\r\nimport * as anchor from '@project-serum/anchor';\r\nimport { clusterApiUrl } from '@solana/web3.js';\r\nimport { WalletAdapterNetwork } from '@solana/wallet-adapter-base';\r\nimport {\r\n  getPhantomWallet,\r\n  getSolflareWallet,\r\n  getSolletWallet,\r\n} from '@solana/wallet-adapter-wallets';\r\n\r\nimport {\r\n  ConnectionProvider,\r\n  WalletProvider,\r\n} from '@solana/wallet-adapter-react';\r\n\r\nimport { WalletDialogProvider } from '@solana/wallet-adapter-material-ui';\r\nimport { ThemeProvider, createTheme } from '@material-ui/core';\r\nimport { ConfettiProvider } from './confetti';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    type: 'dark',\r\n  },\r\n});\r\n\r\nconst candyMachineId = process.env.REACT_APP_CANDY_MACHINE_ID\r\n  ? new anchor.web3.PublicKey(process.env.REACT_APP_CANDY_MACHINE_ID)\r\n  : undefined;\r\n\r\nconst fairLaunchId = new anchor.web3.PublicKey(\r\n  process.env.REACT_APP_FAIR_LAUNCH_ID!,\r\n);\r\n\r\nconst network = process.env.REACT_APP_SOLANA_NETWORK as WalletAdapterNetwork;\r\n\r\nconst rpcHost = process.env.REACT_APP_SOLANA_RPC_HOST!;\r\nconst connection = new anchor.web3.Connection(rpcHost);\r\n\r\nconst startDateSeed = parseInt(process.env.REACT_APP_CANDY_START_DATE!, 10);\r\n\r\nconst txTimeout = 30000; // milliseconds (confirm this works for your project)\r\n\r\nconst App = () => {\r\n  const endpoint = useMemo(() => clusterApiUrl(network), []);\r\n\r\n  const wallets = useMemo(\r\n    () => [getPhantomWallet(), getSolflareWallet(), getSolletWallet()],\r\n    [],\r\n  );\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <ConnectionProvider endpoint={endpoint}>\r\n        <WalletProvider wallets={wallets} autoConnect>\r\n          <WalletDialogProvider>\r\n            <ConfettiProvider>\r\n              <Home\r\n                candyMachineId={candyMachineId}\r\n                fairLaunchId={fairLaunchId}\r\n                connection={connection}\r\n                startDate={startDateSeed}\r\n                txTimeout={txTimeout}\r\n              />\r\n            </ConfettiProvider>\r\n          </WalletDialogProvider>\r\n        </WalletProvider>\r\n      </ConnectionProvider>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}